Looking for config file in /home/kemove/data/3dgs-model/room/cfg_args
Config file found: /home/kemove/data/3dgs-model/room/cfg_args
[ARGS] Device: cuda
[ARGS] Input Model Path: /home/kemove/data/3dgs-model/room
[ARGS] Save Render: True
Reading camera 1/311Reading camera 2/311Reading camera 3/311Reading camera 4/311Reading camera 5/311Reading camera 6/311Reading camera 7/311Reading camera 8/311Reading camera 9/311Reading camera 10/311Reading camera 11/311Reading camera 12/311Reading camera 13/311Reading camera 14/311Reading camera 15/311Reading camera 16/311Reading camera 17/311Reading camera 18/311Reading camera 19/311Reading camera 20/311Reading camera 21/311Reading camera 22/311Reading camera 23/311Reading camera 24/311Reading camera 25/311Reading camera 26/311Reading camera 27/311Reading camera 28/311Reading camera 29/311Reading camera 30/311Reading camera 31/311Reading camera 32/311Reading camera 33/311Reading camera 34/311Reading camera 35/311Reading camera 36/311Reading camera 37/311Reading camera 38/311Reading camera 39/311Reading camera 40/311Reading camera 41/311Reading camera 42/311Reading camera 43/311Reading camera 44/311Reading camera 45/311Reading camera 46/311Reading camera 47/311Reading camera 48/311Reading camera 49/311Reading camera 50/311Reading camera 51/311Reading camera 52/311Reading camera 53/311Reading camera 54/311Reading camera 55/311Reading camera 56/311Reading camera 57/311Reading camera 58/311Reading camera 59/311Reading camera 60/311Reading camera 61/311Reading camera 62/311Reading camera 63/311Reading camera 64/311Reading camera 65/311Reading camera 66/311Reading camera 67/311Reading camera 68/311Reading camera 69/311Reading camera 70/311Reading camera 71/311Reading camera 72/311Reading camera 73/311Reading camera 74/311Reading camera 75/311Reading camera 76/311Reading camera 77/311Reading camera 78/311Reading camera 79/311Reading camera 80/311Reading camera 81/311Reading camera 82/311Reading camera 83/311Reading camera 84/311Reading camera 85/311Reading camera 86/311Reading camera 87/311Reading camera 88/311Reading camera 89/311Reading camera 90/311Reading camera 91/311Reading camera 92/311Reading camera 93/311Reading camera 94/311Reading camera 95/311Reading camera 96/311Reading camera 97/311Reading camera 98/311Reading camera 99/311Reading camera 100/311Reading camera 101/311Reading camera 102/311Reading camera 103/311Reading camera 104/311Reading camera 105/311Reading camera 106/311Reading camera 107/311Reading camera 108/311Reading camera 109/311Reading camera 110/311Reading camera 111/311Reading camera 112/311Reading camera 113/311Reading camera 114/311Reading camera 115/311Reading camera 116/311Reading camera 117/311Reading camera 118/311Reading camera 119/311Reading camera 120/311Reading camera 121/311Reading camera 122/311Reading camera 123/311Reading camera 124/311Reading camera 125/311Reading camera 126/311Reading camera 127/311Reading camera 128/311Reading camera 129/311Reading camera 130/311Reading camera 131/311Reading camera 132/311Reading camera 133/311Reading camera 134/311Reading camera 135/311Reading camera 136/311Reading camera 137/311Reading camera 138/311Reading camera 139/311Reading camera 140/311Reading camera 141/311Reading camera 142/311Reading camera 143/311Reading camera 144/311Reading camera 145/311Reading camera 146/311Reading camera 147/311Reading camera 148/311Reading camera 149/311Reading camera 150/311Reading camera 151/311Reading camera 152/311Reading camera 153/311Reading camera 154/311Reading camera 155/311Reading camera 156/311Reading camera 157/311Reading camera 158/311Reading camera 159/311Reading camera 160/311Reading camera 161/311Reading camera 162/311Reading camera 163/311Reading camera 164/311Reading camera 165/311Reading camera 166/311Reading camera 167/311Reading camera 168/311Reading camera 169/311Reading camera 170/311Reading camera 171/311Reading camera 172/311Reading camera 173/311Reading camera 174/311Reading camera 175/311Reading camera 176/311Reading camera 177/311Reading camera 178/311Reading camera 179/311Reading camera 180/311Reading camera 181/311Reading camera 182/311Reading camera 183/311Reading camera 184/311Reading camera 185/311Reading camera 186/311Reading camera 187/311Reading camera 188/311Reading camera 189/311Reading camera 190/311Reading camera 191/311Reading camera 192/311Reading camera 193/311Reading camera 194/311Reading camera 195/311Reading camera 196/311Reading camera 197/311Reading camera 198/311Reading camera 199/311Reading camera 200/311Reading camera 201/311Reading camera 202/311Reading camera 203/311Reading camera 204/311Reading camera 205/311Reading camera 206/311Reading camera 207/311Reading camera 208/311Reading camera 209/311Reading camera 210/311Reading camera 211/311Reading camera 212/311Reading camera 213/311Reading camera 214/311Reading camera 215/311Reading camera 216/311Reading camera 217/311Reading camera 218/311Reading camera 219/311Reading camera 220/311Reading camera 221/311Reading camera 222/311Reading camera 223/311Reading camera 224/311Reading camera 225/311Reading camera 226/311Reading camera 227/311Reading camera 228/311Reading camera 229/311Reading camera 230/311Reading camera 231/311Reading camera 232/311Reading camera 233/311Reading camera 234/311Reading camera 235/311Reading camera 236/311Reading camera 237/311Reading camera 238/311Reading camera 239/311Reading camera 240/311Reading camera 241/311Reading camera 242/311Reading camera 243/311Reading camera 244/311Reading camera 245/311Reading camera 246/311Reading camera 247/311Reading camera 248/311Reading camera 249/311Reading camera 250/311Reading camera 251/311Reading camera 252/311Reading camera 253/311Reading camera 254/311Reading camera 255/311Reading camera 256/311Reading camera 257/311Reading camera 258/311Reading camera 259/311Reading camera 260/311Reading camera 261/311Reading camera 262/311Reading camera 263/311Reading camera 264/311Reading camera 265/311Reading camera 266/311Reading camera 267/311Reading camera 268/311Reading camera 269/311Reading camera 270/311Reading camera 271/311Reading camera 272/311Reading camera 273/311Reading camera 274/311Reading camera 275/311Reading camera 276/311Reading camera 277/311Reading camera 278/311Reading camera 279/311Reading camera 280/311Reading camera 281/311Reading camera 282/311Reading camera 283/311Reading camera 284/311Reading camera 285/311Reading camera 286/311Reading camera 287/311Reading camera 288/311Reading camera 289/311Reading camera 290/311Reading camera 291/311Reading camera 292/311Reading camera 293/311Reading camera 294/311Reading camera 295/311Reading camera 296/311Reading camera 297/311Reading camera 298/311Reading camera 299/311Reading camera 300/311Reading camera 301/311Reading camera 302/311Reading camera 303/311Reading camera 304/311Reading camera 305/311Reading camera 306/311Reading camera 307/311Reading camera 308/311Reading camera 309/311Reading camera 310/311Reading camera 311/311
  Scene info loaded in 0.93 s
Loading Training Cameras
  Training cameras loaded in 3.92 s
Loading Test Cameras
  Test cameras loaded in 1.87 s
Loading PLY file...
  PLY file loaded in 2.02 s
[INFO] Computing importance scores...
[V4] Step 1: Evaluating view importance for all views...
[V3] Evaluating view importance for all 272 views...

[Overall] Importance contribution breakdown (averaged over 272 views):
  image_variance contribution: 0.712529 (1.08%)
  gradient_magnitude contribution: 0.427038 (0.65%)
  visibility_score contribution: 64.567295 (98.27%)
  Total importance: 65.706863
[V4] Using all 272 views, with top-27 (10.0%) important views weighted 2.0x
Computing importance (V4):   0%|          | 0/272 [00:00<?, ?it/s]Computing importance (V4):   1%|          | 3/272 [00:00<00:08, 29.97it/s]Computing importance (V4):   3%|▎         | 7/272 [00:00<00:08, 31.70it/s]Computing importance (V4):   4%|▍         | 11/272 [00:00<00:08, 31.73it/s]Computing importance (V4):   6%|▌         | 15/272 [00:00<00:08, 31.85it/s]Computing importance (V4):   7%|▋         | 19/272 [00:00<00:07, 33.21it/s]Computing importance (V4):   8%|▊         | 23/272 [00:00<00:07, 33.38it/s]Computing importance (V4):  10%|▉         | 27/272 [00:00<00:07, 31.75it/s]Computing importance (V4):  11%|█▏        | 31/272 [00:00<00:07, 31.30it/s]Computing importance (V4):  13%|█▎        | 35/272 [00:01<00:07, 30.58it/s]Computing importance (V4):  14%|█▍        | 39/272 [00:01<00:07, 31.25it/s]Computing importance (V4):  16%|█▌        | 43/272 [00:01<00:07, 31.34it/s]Computing importance (V4):  17%|█▋        | 47/272 [00:01<00:07, 31.36it/s]Computing importance (V4):  19%|█▉        | 51/272 [00:01<00:06, 31.76it/s]Computing importance (V4):  20%|██        | 55/272 [00:01<00:06, 31.63it/s]Computing importance (V4):  22%|██▏       | 59/272 [00:01<00:06, 32.08it/s]Computing importance (V4):  23%|██▎       | 63/272 [00:01<00:06, 31.96it/s]Computing importance (V4):  25%|██▍       | 67/272 [00:02<00:06, 32.40it/s]Computing importance (V4):  26%|██▌       | 71/272 [00:02<00:06, 33.14it/s]Computing importance (V4):  28%|██▊       | 75/272 [00:02<00:06, 32.57it/s]Computing importance (V4):  29%|██▉       | 79/272 [00:02<00:05, 33.57it/s]Computing importance (V4):  31%|███       | 83/272 [00:02<00:05, 33.29it/s]Computing importance (V4):  32%|███▏      | 87/272 [00:02<00:05, 31.89it/s]Computing importance (V4):  33%|███▎      | 91/272 [00:02<00:05, 32.21it/s]Computing importance (V4):  35%|███▍      | 95/272 [00:02<00:05, 32.31it/s]Computing importance (V4):  36%|███▋      | 99/272 [00:03<00:05, 32.24it/s]Computing importance (V4):  38%|███▊      | 103/272 [00:03<00:05, 31.86it/s]Computing importance (V4):  39%|███▉      | 107/272 [00:03<00:05, 31.71it/s]Computing importance (V4):  41%|████      | 111/272 [00:03<00:05, 31.33it/s]Computing importance (V4):  42%|████▏     | 115/272 [00:03<00:04, 32.03it/s]Computing importance (V4):  44%|████▍     | 119/272 [00:03<00:04, 32.44it/s]Computing importance (V4):  45%|████▌     | 123/272 [00:03<00:04, 31.90it/s]Computing importance (V4):  47%|████▋     | 127/272 [00:03<00:04, 32.13it/s]Computing importance (V4):  48%|████▊     | 131/272 [00:04<00:04, 31.68it/s]Computing importance (V4):  50%|████▉     | 135/272 [00:04<00:04, 32.18it/s]Computing importance (V4):  51%|█████     | 139/272 [00:04<00:04, 31.96it/s]Computing importance (V4):  53%|█████▎    | 143/272 [00:04<00:04, 31.75it/s]Computing importance (V4):  54%|█████▍    | 147/272 [00:04<00:03, 32.51it/s]Computing importance (V4):  56%|█████▌    | 151/272 [00:04<00:03, 31.54it/s]Computing importance (V4):  57%|█████▋    | 155/272 [00:04<00:03, 32.13it/s]Computing importance (V4):  58%|█████▊    | 159/272 [00:04<00:03, 31.54it/s]Computing importance (V4):  60%|█████▉    | 163/272 [00:05<00:03, 31.43it/s]Computing importance (V4):  61%|██████▏   | 167/272 [00:05<00:03, 31.69it/s]Computing importance (V4):  63%|██████▎   | 171/272 [00:05<00:03, 32.10it/s]Computing importance (V4):  64%|██████▍   | 175/272 [00:05<00:02, 32.43it/s]Computing importance (V4):  66%|██████▌   | 179/272 [00:05<00:02, 32.71it/s]Computing importance (V4):  67%|██████▋   | 183/272 [00:05<00:02, 32.50it/s]Computing importance (V4):  69%|██████▉   | 187/272 [00:05<00:02, 32.94it/s]Computing importance (V4):  70%|███████   | 191/272 [00:05<00:02, 31.76it/s]Computing importance (V4):  72%|███████▏  | 195/272 [00:06<00:02, 32.18it/s]Computing importance (V4):  73%|███████▎  | 199/272 [00:06<00:02, 31.08it/s]Computing importance (V4):  75%|███████▍  | 203/272 [00:06<00:02, 31.73it/s]Computing importance (V4):  76%|███████▌  | 207/272 [00:06<00:02, 31.56it/s]Computing importance (V4):  78%|███████▊  | 211/272 [00:06<00:01, 31.80it/s]Computing importance (V4):  79%|███████▉  | 215/272 [00:06<00:01, 32.51it/s]Computing importance (V4):  81%|████████  | 219/272 [00:06<00:01, 31.62it/s]Computing importance (V4):  82%|████████▏ | 223/272 [00:06<00:01, 31.94it/s]Computing importance (V4):  83%|████████▎ | 227/272 [00:07<00:01, 31.25it/s]Computing importance (V4):  85%|████████▍ | 231/272 [00:07<00:01, 31.07it/s]Computing importance (V4):  86%|████████▋ | 235/272 [00:07<00:01, 31.23it/s]Computing importance (V4):  88%|████████▊ | 239/272 [00:07<00:01, 32.26it/s]Computing importance (V4):  89%|████████▉ | 243/272 [00:07<00:00, 32.54it/s]Computing importance (V4):  91%|█████████ | 247/272 [00:07<00:00, 31.58it/s]Computing importance (V4):  92%|█████████▏| 251/272 [00:07<00:00, 32.28it/s]Computing importance (V4):  94%|█████████▍| 255/272 [00:07<00:00, 33.02it/s]Computing importance (V4):  95%|█████████▌| 259/272 [00:08<00:00, 33.04it/s]Computing importance (V4):  97%|█████████▋| 263/272 [00:08<00:00, 32.32it/s]Computing importance (V4):  98%|█████████▊| 267/272 [00:08<00:00, 32.32it/s]Computing importance (V4): 100%|█████████▉| 271/272 [00:08<00:00, 31.74it/s]Computing importance (V4): 100%|██████████| 272/272 [00:08<00:00, 32.01it/s]

[V4] Gradient Component Statistics (Mean Values):
--------------------------------------------------
Component          Raw Value   Relative %
--------------------------------------------------
xyz                 0.000005       72.81%
scaling             0.000000        2.76%
rotation            0.000000        5.91%
dc                  0.000000        3.71%
sh                  0.000001       14.38%
opacity             0.000000        0.42%
--------------------------------------------------

[V4] Weighted Gradient Contributions:
--------------------------------------------------
Component         Weight    Contrib %
--------------------------------------------------
xyz                 0.02       16.76%
scaling             1.00       31.77%
rotation            0.20       13.61%
dc                  0.10        4.27%
sh                  0.20       33.11%
opacity             0.10        0.48%
--------------------------------------------------

[Baseline] ...
psnr:  31.400238526173126
  Baseline render time:   0.33 s
  Baseline PSNR:          31.4002 dB

[Search] [Seed] pruning_rate=0.70, sh_rate=0.20, mem_score=1.460, ΔPSNR=1.1211 dB [FAIL]
  Deep copy time:         0.0006 s
  Prune time:             0.18 s
psnr:  30.279146536802635
  Render time: 0.21s
  PSNR after pruning: 30.2791
  ΔPSNR after pruning: 1.1211 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Seed] pruning_rate=0.60, sh_rate=0.30, mem_score=1.380, ΔPSNR=0.7600 dB [FAIL]
  Deep copy time:         0.0004 s
  Prune time:             0.18 s
psnr:  30.640217658800957
  Render time: 0.23s
  PSNR after pruning: 30.6402
  ΔPSNR after pruning: 0.7600 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Seed] pruning_rate=0.40, sh_rate=0.50, mem_score=1.220, ΔPSNR=0.6517 dB [FAIL]
  Deep copy time:         0.0003 s
  Prune time:             0.18 s
psnr:  30.748488744099934
  Render time: 0.26s
  PSNR after pruning: 30.7485
  ΔPSNR after pruning: 0.6517 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Seed] pruning_rate=0.40, sh_rate=0.40, mem_score=1.120, ΔPSNR=0.2404 dB [OK]
  Deep copy time:         0.0004 s
  Prune time:             0.18 s
psnr:  31.159805444570686
  Render time: 0.26s
  PSNR after pruning: 31.1598
  ΔPSNR after pruning: 0.2404 dB
  [INFO] New best config: mem_score=1.120, ΔPSNR=0.2404 dB

[Search] [Neighbor] pruning_rate=0.44, sh_rate=0.40, mem_score=1.192, ΔPSNR=0.3563 dB [OK]
  Deep copy time:         0.0003 s
  Prune time:             0.18 s
psnr:  31.04396262535682
  Render time: 0.25s
  PSNR after pruning: 31.0440
  ΔPSNR after pruning: 0.3563 dB
  [INFO] New best config: mem_score=1.192, ΔPSNR=0.3563 dB
  [INFO] Queue cleanup: removed 1 low mem_score configs (queue: 3 -> 2)

[Search] [Neighbor] pruning_rate=0.46, sh_rate=0.40, mem_score=1.228, ΔPSNR=0.4367 dB [OK]
  Deep copy time:         0.0003 s
  Prune time:             0.18 s
psnr:  30.963553942166843
  Render time: 0.25s
  PSNR after pruning: 30.9636
  ΔPSNR after pruning: 0.4367 dB
  [INFO] New best config: mem_score=1.228, ΔPSNR=0.4367 dB
  [INFO] Queue cleanup: removed 1 low mem_score configs (queue: 3 -> 2)

[Search] [Neighbor] pruning_rate=0.47, sh_rate=0.40, mem_score=1.246, ΔPSNR=0.4840 dB [OK]
  Deep copy time:         0.0004 s
  Prune time:             0.18 s
psnr:  30.916217657235954
  Render time: 0.25s
  PSNR after pruning: 30.9162
  ΔPSNR after pruning: 0.4840 dB
  [INFO] New best config: mem_score=1.246, ΔPSNR=0.4840 dB
  [INFO] Queue cleanup: removed 1 low mem_score configs (queue: 3 -> 2)

[Search] [Neighbor] pruning_rate=0.48, sh_rate=0.40, mem_score=1.264, ΔPSNR=0.5382 dB [OK]
  Deep copy time:         0.0003 s
  Prune time:             0.18 s
psnr:  30.862084462092472
  Render time: 0.25s
  PSNR after pruning: 30.8621
  ΔPSNR after pruning: 0.5382 dB
  [INFO] New best config: mem_score=1.264, ΔPSNR=0.5382 dB
  [INFO] Queue cleanup: removed 1 low mem_score configs (queue: 3 -> 2)

[INFO] Early stop in neighbor search: best PSNR drop (0.5382 dB) >= 95% of target (0.5500 dB)

[Search] Total configurations evaluated: 8

[Finalize] Running quantization for pruning_rate=0.48, sh_rate=0.40
  Deep copy time:         0.0003 s
  Prune time:             0.18 s
psnr:  30.862084462092472
  Render time: 53.49s
  PSNR after pruning: 30.8621
  ΔPSNR after pruning: 0.5382 dB
  Quantization breakdown -> prep_tensors: 0.000s, zero_mask_split: 0.001s, xyz_quant_morton: 0.006s, cpu_transfer: 0.047s, xyz_q16_encode: 0.206s, f_rest_int4: 0.690s, int8_pack: 0.751s
  Quantization time:      1.70 s
  Dequantization time:    0.81 s
  Estimated size:         16.39 MB
  Storage ratio vs input: 4.35%
[INFO] Storage breakdown:
    M_int8_compressed: 8.55 MB (52.15%)
    xyz_q16_compressed: 3.91 MB (23.85%)
    M_rest_compressed: 3.42 MB (20.87%)
    Z_rest: 175.83 KB (1.05%)
    S_rest: 175.83 KB (1.05%)
    Z_int8: 85.99 KB (0.51%)
    S_int8: 85.99 KB (0.51%)
    npz_path: 208.00 B (0.00%)
    int8_names: 131.00 B (0.00%)
    xyz_codec_used: 120.00 B (0.00%)
    compression_method: 120.00 B (0.00%)
    xyz_codec: 115.00 B (0.00%)
    xyz_q16_shape_uint16: 109.00 B (0.00%)
    xyz_q16_shape_bytes: 108.00 B (0.00%)
    xyz_q16_view_shape: 107.00 B (0.00%)
    M_rest_shape: 101.00 B (0.00%)
    M_int8_shape: 101.00 B (0.00%)
    int4_names: 99.00 B (0.00%)
    int2_names: 99.00 B (0.00%)
    fp16_names: 99.00 B (0.00%)
    segment_size_f_rest: 96.00 B (0.00%)
    use_entropy_coding: 95.00 B (0.00%)
    compression_level: 94.00 B (0.00%)
    boundary_index: 91.00 B (0.00%)
    num_segments: 89.00 B (0.00%)
    bits_f_rest: 88.00 B (0.00%)
    xyz_qbits: 86.00 B (0.00%)
    sh_all_zero: 84.00 B (0.00%)
    N_rest: 83.00 B (0.00%)
    N: 78.00 B (0.00%)
    xyz_mins: 69.00 B (0.00%)
    xyz_maxs: 69.00 B (0.00%)
psnr:  30.82817899263822
  Final render time:      53.38 s
  Final PSNR:             30.8282 dB
  ΔPSNR from input:       0.5721 dB

Search complete.

============================================================
Best combination found: pruning=0.480, sh=0.400

[INFO] Best config:           pruning_rate = 0.480, sh_rate = 0.400
[INFO] Base PSNR:             31.4002 dB
[INFO] Best PSNR:             30.8282 dB
[INFO] PSNR drop:             0.5721 dB
[INFO] Input file size:       376.85 MB
[INFO] Output file size:      16.39 MB
[INFO] Compression ratio:     22.99x
============================================================
 Saving render results ...
  Deep copy time:         0.0007 s
  Prune time:             0.19 s
psnr:  30.862084462092472
  Render time: 52.10s
  PSNR after pruning: 30.8621
  ΔPSNR after pruning: 0.5382 dB

============================================================
[STATS] Pipeline Time Breakdown:
  Load time:      8.74 s
  Score time:    11.88 s
  Search time:  113.31 s
  Store time:    52.33 s
  Total time:   186.26 s
============================================================
	Command being timed: "python /home/kemove/github/FlexGaussian/compress.py -s /home/kemove/data/mipnerf360/room -m /home/kemove/data/3dgs-model/room --output_path /home/kemove/efficient-output --quality_target_diff 0.55 --eval --compression_method zlib --compression_level 4 --xyz_codec morton16 --segments 1000 --use_importance_v4 True --topk_views_percent 0.1 --view_importance_weight 2.0 --save_render True"
	User time (seconds): 586.29
	System time (seconds): 39.10
	Percent of CPU this job got: 331%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 3:08.88
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 14544548
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 153
	Minor (reclaiming a frame) page faults: 3871594
	Voluntary context switches: 56066
	Involuntary context switches: 2830
	Swaps: 0
	File system inputs: 0
	File system outputs: 807120
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
