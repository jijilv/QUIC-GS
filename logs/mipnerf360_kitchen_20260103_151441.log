Looking for config file in /home/kemove/data/3dgs-model/kitchen/cfg_args
Config file found: /home/kemove/data/3dgs-model/kitchen/cfg_args
[ARGS] Device: cuda
[ARGS] Input Model Path: /home/kemove/data/3dgs-model/kitchen
[ARGS] Save Render: True
Reading camera 1/279Reading camera 2/279Reading camera 3/279Reading camera 4/279Reading camera 5/279Reading camera 6/279Reading camera 7/279Reading camera 8/279Reading camera 9/279Reading camera 10/279Reading camera 11/279Reading camera 12/279Reading camera 13/279Reading camera 14/279Reading camera 15/279Reading camera 16/279Reading camera 17/279Reading camera 18/279Reading camera 19/279Reading camera 20/279Reading camera 21/279Reading camera 22/279Reading camera 23/279Reading camera 24/279Reading camera 25/279Reading camera 26/279Reading camera 27/279Reading camera 28/279Reading camera 29/279Reading camera 30/279Reading camera 31/279Reading camera 32/279Reading camera 33/279Reading camera 34/279Reading camera 35/279Reading camera 36/279Reading camera 37/279Reading camera 38/279Reading camera 39/279Reading camera 40/279Reading camera 41/279Reading camera 42/279Reading camera 43/279Reading camera 44/279Reading camera 45/279Reading camera 46/279Reading camera 47/279Reading camera 48/279Reading camera 49/279Reading camera 50/279Reading camera 51/279Reading camera 52/279Reading camera 53/279Reading camera 54/279Reading camera 55/279Reading camera 56/279Reading camera 57/279Reading camera 58/279Reading camera 59/279Reading camera 60/279Reading camera 61/279Reading camera 62/279Reading camera 63/279Reading camera 64/279Reading camera 65/279Reading camera 66/279Reading camera 67/279Reading camera 68/279Reading camera 69/279Reading camera 70/279Reading camera 71/279Reading camera 72/279Reading camera 73/279Reading camera 74/279Reading camera 75/279Reading camera 76/279Reading camera 77/279Reading camera 78/279Reading camera 79/279Reading camera 80/279Reading camera 81/279Reading camera 82/279Reading camera 83/279Reading camera 84/279Reading camera 85/279Reading camera 86/279Reading camera 87/279Reading camera 88/279Reading camera 89/279Reading camera 90/279Reading camera 91/279Reading camera 92/279Reading camera 93/279Reading camera 94/279Reading camera 95/279Reading camera 96/279Reading camera 97/279Reading camera 98/279Reading camera 99/279Reading camera 100/279Reading camera 101/279Reading camera 102/279Reading camera 103/279Reading camera 104/279Reading camera 105/279Reading camera 106/279Reading camera 107/279Reading camera 108/279Reading camera 109/279Reading camera 110/279Reading camera 111/279Reading camera 112/279Reading camera 113/279Reading camera 114/279Reading camera 115/279Reading camera 116/279Reading camera 117/279Reading camera 118/279Reading camera 119/279Reading camera 120/279Reading camera 121/279Reading camera 122/279Reading camera 123/279Reading camera 124/279Reading camera 125/279Reading camera 126/279Reading camera 127/279Reading camera 128/279Reading camera 129/279Reading camera 130/279Reading camera 131/279Reading camera 132/279Reading camera 133/279Reading camera 134/279Reading camera 135/279Reading camera 136/279Reading camera 137/279Reading camera 138/279Reading camera 139/279Reading camera 140/279Reading camera 141/279Reading camera 142/279Reading camera 143/279Reading camera 144/279Reading camera 145/279Reading camera 146/279Reading camera 147/279Reading camera 148/279Reading camera 149/279Reading camera 150/279Reading camera 151/279Reading camera 152/279Reading camera 153/279Reading camera 154/279Reading camera 155/279Reading camera 156/279Reading camera 157/279Reading camera 158/279Reading camera 159/279Reading camera 160/279Reading camera 161/279Reading camera 162/279Reading camera 163/279Reading camera 164/279Reading camera 165/279Reading camera 166/279Reading camera 167/279Reading camera 168/279Reading camera 169/279Reading camera 170/279Reading camera 171/279Reading camera 172/279Reading camera 173/279Reading camera 174/279Reading camera 175/279Reading camera 176/279Reading camera 177/279Reading camera 178/279Reading camera 179/279Reading camera 180/279Reading camera 181/279Reading camera 182/279Reading camera 183/279Reading camera 184/279Reading camera 185/279Reading camera 186/279Reading camera 187/279Reading camera 188/279Reading camera 189/279Reading camera 190/279Reading camera 191/279Reading camera 192/279Reading camera 193/279Reading camera 194/279Reading camera 195/279Reading camera 196/279Reading camera 197/279Reading camera 198/279Reading camera 199/279Reading camera 200/279Reading camera 201/279Reading camera 202/279Reading camera 203/279Reading camera 204/279Reading camera 205/279Reading camera 206/279Reading camera 207/279Reading camera 208/279Reading camera 209/279Reading camera 210/279Reading camera 211/279Reading camera 212/279Reading camera 213/279Reading camera 214/279Reading camera 215/279Reading camera 216/279Reading camera 217/279Reading camera 218/279Reading camera 219/279Reading camera 220/279Reading camera 221/279Reading camera 222/279Reading camera 223/279Reading camera 224/279Reading camera 225/279Reading camera 226/279Reading camera 227/279Reading camera 228/279Reading camera 229/279Reading camera 230/279Reading camera 231/279Reading camera 232/279Reading camera 233/279Reading camera 234/279Reading camera 235/279Reading camera 236/279Reading camera 237/279Reading camera 238/279Reading camera 239/279Reading camera 240/279Reading camera 241/279Reading camera 242/279Reading camera 243/279Reading camera 244/279Reading camera 245/279Reading camera 246/279Reading camera 247/279Reading camera 248/279Reading camera 249/279Reading camera 250/279Reading camera 251/279Reading camera 252/279Reading camera 253/279Reading camera 254/279Reading camera 255/279Reading camera 256/279Reading camera 257/279Reading camera 258/279Reading camera 259/279Reading camera 260/279Reading camera 261/279Reading camera 262/279Reading camera 263/279Reading camera 264/279Reading camera 265/279Reading camera 266/279Reading camera 267/279Reading camera 268/279Reading camera 269/279Reading camera 270/279Reading camera 271/279Reading camera 272/279Reading camera 273/279Reading camera 274/279Reading camera 275/279Reading camera 276/279Reading camera 277/279Reading camera 278/279Reading camera 279/279
  Scene info loaded in 1.56 s
Loading Training Cameras
  Training cameras loaded in 3.12 s
Loading Test Cameras
  Test cameras loaded in 1.82 s
Loading PLY file...
  PLY file loaded in 2.44 s
[INFO] Computing importance scores...
[V4] Step 1: Evaluating view importance for all views...
[V3] Evaluating view importance for all 244 views...

[Overall] Importance contribution breakdown (averaged over 244 views):
  image_variance contribution: 0.547451 (0.36%)
  gradient_magnitude contribution: 0.935812 (0.62%)
  visibility_score contribution: 148.891289 (99.01%)
  Total importance: 150.374552
[V4] Using all 244 views, with top-24 (10.0%) important views weighted 2.0x
Computing importance (V4):   0%|          | 0/244 [00:00<?, ?it/s]Computing importance (V4):   1%|          | 3/244 [00:00<00:08, 27.77it/s]Computing importance (V4):   2%|▏         | 6/244 [00:00<00:08, 28.67it/s]Computing importance (V4):   4%|▎         | 9/244 [00:00<00:08, 29.15it/s]Computing importance (V4):   5%|▍         | 12/244 [00:00<00:07, 29.09it/s]Computing importance (V4):   6%|▌         | 15/244 [00:00<00:07, 29.19it/s]Computing importance (V4):   7%|▋         | 18/244 [00:00<00:07, 29.30it/s]Computing importance (V4):   9%|▊         | 21/244 [00:00<00:07, 29.34it/s]Computing importance (V4):  10%|▉         | 24/244 [00:00<00:07, 29.23it/s]Computing importance (V4):  11%|█         | 27/244 [00:00<00:07, 28.99it/s]Computing importance (V4):  13%|█▎        | 31/244 [00:01<00:07, 29.29it/s]Computing importance (V4):  14%|█▍        | 34/244 [00:01<00:07, 29.27it/s]Computing importance (V4):  15%|█▌        | 37/244 [00:01<00:07, 29.43it/s]Computing importance (V4):  16%|█▋        | 40/244 [00:01<00:06, 29.24it/s]Computing importance (V4):  18%|█▊        | 43/244 [00:01<00:06, 28.92it/s]Computing importance (V4):  19%|█▉        | 46/244 [00:01<00:06, 28.78it/s]Computing importance (V4):  20%|██        | 49/244 [00:01<00:06, 28.55it/s]Computing importance (V4):  21%|██▏       | 52/244 [00:01<00:06, 28.68it/s]Computing importance (V4):  23%|██▎       | 55/244 [00:01<00:06, 28.49it/s]Computing importance (V4):  24%|██▍       | 58/244 [00:02<00:06, 28.54it/s]Computing importance (V4):  25%|██▌       | 61/244 [00:02<00:06, 28.51it/s]Computing importance (V4):  26%|██▌       | 64/244 [00:02<00:06, 28.67it/s]Computing importance (V4):  27%|██▋       | 67/244 [00:02<00:06, 28.79it/s]Computing importance (V4):  29%|██▊       | 70/244 [00:02<00:06, 28.88it/s]Computing importance (V4):  30%|██▉       | 73/244 [00:02<00:06, 28.33it/s]Computing importance (V4):  31%|███       | 76/244 [00:02<00:05, 28.53it/s]Computing importance (V4):  32%|███▏      | 79/244 [00:02<00:05, 28.61it/s]Computing importance (V4):  34%|███▎      | 82/244 [00:02<00:05, 28.12it/s]Computing importance (V4):  35%|███▍      | 85/244 [00:02<00:05, 28.07it/s]Computing importance (V4):  36%|███▌      | 88/244 [00:03<00:05, 28.42it/s]Computing importance (V4):  37%|███▋      | 91/244 [00:03<00:05, 28.55it/s]Computing importance (V4):  39%|███▊      | 94/244 [00:03<00:05, 28.67it/s]Computing importance (V4):  40%|███▉      | 97/244 [00:03<00:05, 28.18it/s]Computing importance (V4):  41%|████      | 100/244 [00:03<00:05, 28.16it/s]Computing importance (V4):  42%|████▏     | 103/244 [00:03<00:04, 28.31it/s]Computing importance (V4):  43%|████▎     | 106/244 [00:03<00:04, 28.23it/s]Computing importance (V4):  45%|████▍     | 109/244 [00:03<00:04, 28.43it/s]Computing importance (V4):  46%|████▌     | 112/244 [00:03<00:04, 28.57it/s]Computing importance (V4):  47%|████▋     | 115/244 [00:04<00:04, 28.58it/s]Computing importance (V4):  48%|████▊     | 118/244 [00:04<00:04, 28.58it/s]Computing importance (V4):  50%|████▉     | 121/244 [00:04<00:04, 28.27it/s]Computing importance (V4):  51%|█████     | 124/244 [00:04<00:04, 28.62it/s]Computing importance (V4):  52%|█████▏    | 127/244 [00:04<00:04, 28.33it/s]Computing importance (V4):  54%|█████▎    | 131/244 [00:04<00:03, 28.92it/s]Computing importance (V4):  55%|█████▍    | 134/244 [00:04<00:03, 29.03it/s]Computing importance (V4):  56%|█████▌    | 137/244 [00:04<00:03, 28.90it/s]Computing importance (V4):  57%|█████▋    | 140/244 [00:04<00:03, 28.93it/s]Computing importance (V4):  59%|█████▊    | 143/244 [00:04<00:03, 28.77it/s]Computing importance (V4):  60%|█████▉    | 146/244 [00:05<00:03, 28.10it/s]Computing importance (V4):  61%|██████    | 149/244 [00:05<00:03, 27.89it/s]Computing importance (V4):  62%|██████▏   | 152/244 [00:05<00:03, 27.91it/s]Computing importance (V4):  64%|██████▎   | 155/244 [00:05<00:03, 28.29it/s]Computing importance (V4):  65%|██████▍   | 158/244 [00:05<00:03, 28.27it/s]Computing importance (V4):  66%|██████▌   | 161/244 [00:05<00:02, 28.26it/s]Computing importance (V4):  67%|██████▋   | 164/244 [00:05<00:02, 28.08it/s]Computing importance (V4):  68%|██████▊   | 167/244 [00:05<00:02, 28.41it/s]Computing importance (V4):  70%|██████▉   | 170/244 [00:05<00:02, 27.89it/s]Computing importance (V4):  71%|███████   | 173/244 [00:06<00:02, 28.14it/s]Computing importance (V4):  72%|███████▏  | 176/244 [00:06<00:02, 27.89it/s]Computing importance (V4):  73%|███████▎  | 179/244 [00:06<00:02, 28.28it/s]Computing importance (V4):  75%|███████▍  | 182/244 [00:06<00:02, 28.56it/s]Computing importance (V4):  76%|███████▌  | 185/244 [00:06<00:02, 28.50it/s]Computing importance (V4):  77%|███████▋  | 188/244 [00:06<00:01, 28.46it/s]Computing importance (V4):  78%|███████▊  | 191/244 [00:06<00:01, 28.67it/s]Computing importance (V4):  80%|███████▉  | 194/244 [00:06<00:01, 27.67it/s]Computing importance (V4):  81%|████████  | 197/244 [00:06<00:01, 27.97it/s]Computing importance (V4):  82%|████████▏ | 200/244 [00:07<00:01, 28.24it/s]Computing importance (V4):  83%|████████▎ | 203/244 [00:07<00:01, 28.32it/s]Computing importance (V4):  84%|████████▍ | 206/244 [00:07<00:01, 28.45it/s]Computing importance (V4):  86%|████████▌ | 209/244 [00:07<00:01, 28.55it/s]Computing importance (V4):  87%|████████▋ | 212/244 [00:07<00:01, 28.76it/s]Computing importance (V4):  88%|████████▊ | 215/244 [00:07<00:01, 28.81it/s]Computing importance (V4):  89%|████████▉ | 218/244 [00:07<00:00, 28.03it/s]Computing importance (V4):  91%|█████████ | 221/244 [00:07<00:00, 28.28it/s]Computing importance (V4):  92%|█████████▏| 224/244 [00:07<00:00, 28.54it/s]Computing importance (V4):  93%|█████████▎| 227/244 [00:07<00:00, 28.89it/s]Computing importance (V4):  94%|█████████▍| 230/244 [00:08<00:00, 28.72it/s]Computing importance (V4):  95%|█████████▌| 233/244 [00:08<00:00, 28.76it/s]Computing importance (V4):  97%|█████████▋| 236/244 [00:08<00:00, 28.81it/s]Computing importance (V4):  98%|█████████▊| 239/244 [00:08<00:00, 28.96it/s]Computing importance (V4):  99%|█████████▉| 242/244 [00:08<00:00, 27.99it/s]Computing importance (V4): 100%|██████████| 244/244 [00:08<00:00, 28.54it/s]

[V4] Gradient Component Statistics (Mean Values):
--------------------------------------------------
Component          Raw Value   Relative %
--------------------------------------------------
xyz                 0.000016       89.19%
scaling             0.000000        1.16%
rotation            0.000000        2.48%
dc                  0.000000        1.41%
sh                  0.000001        5.47%
opacity             0.000000        0.29%
--------------------------------------------------

[V4] Weighted Gradient Contributions:
--------------------------------------------------
Component         Weight    Contrib %
--------------------------------------------------
xyz                 0.02       37.96%
scaling             1.00       24.58%
rotation            0.20       10.53%
dc                  0.10        3.01%
sh                  0.20       23.29%
opacity             0.10        0.62%
--------------------------------------------------

[Baseline] ...
psnr:  30.81112905229841
  Baseline render time:   0.33 s
  Baseline PSNR:          30.8111 dB

[Search] [Seed] pruning_rate=0.70, sh_rate=0.20, mem_score=1.460, ΔPSNR=3.5820 dB [FAIL]
  Deep copy time:         0.0007 s
  Prune time:             0.22 s
psnr:  27.22914150782994
  Render time: 0.19s
  PSNR after pruning: 27.2291
  ΔPSNR after pruning: 3.5820 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Seed] pruning_rate=0.60, sh_rate=0.30, mem_score=1.380, ΔPSNR=2.4628 dB [FAIL]
  Deep copy time:         0.0003 s
  Prune time:             0.22 s
psnr:  28.348357336861746
  Render time: 0.21s
  PSNR after pruning: 28.3484
  ΔPSNR after pruning: 2.4628 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Seed] pruning_rate=0.40, sh_rate=0.50, mem_score=1.220, ΔPSNR=1.9759 dB [FAIL]
  Deep copy time:         0.0003 s
  Prune time:             0.22 s
psnr:  28.83522060939244
  Render time: 0.26s
  PSNR after pruning: 28.8352
  ΔPSNR after pruning: 1.9759 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Seed] pruning_rate=0.40, sh_rate=0.40, mem_score=1.120, ΔPSNR=0.9554 dB [FAIL]
  Deep copy time:         0.0003 s
  Prune time:             0.22 s
psnr:  29.855681937081474
  Render time: 0.26s
  PSNR after pruning: 29.8557
  ΔPSNR after pruning: 0.9554 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Seed] pruning_rate=0.40, sh_rate=0.30, mem_score=1.020, ΔPSNR=0.4735 dB [OK]
  Deep copy time:         0.0003 s
  Prune time:             0.22 s
psnr:  30.337592588152205
  Render time: 0.26s
  PSNR after pruning: 30.3376
  ΔPSNR after pruning: 0.4735 dB
  [INFO] New best config: mem_score=1.020, ΔPSNR=0.4735 dB

[Search] [Neighbor] pruning_rate=0.41, sh_rate=0.30, mem_score=1.038, ΔPSNR=0.5185 dB [OK]
  Deep copy time:         0.0004 s
  Prune time:             0.22 s
psnr:  30.292586462838308
  Render time: 0.26s
  PSNR after pruning: 30.2926
  ΔPSNR after pruning: 0.5185 dB
  [INFO] New best config: mem_score=1.038, ΔPSNR=0.5185 dB
  [INFO] Queue cleanup: removed 1 low mem_score configs (queue: 3 -> 2)

[Search] [Neighbor] pruning_rate=0.42, sh_rate=0.30, mem_score=1.056, ΔPSNR=0.5657 dB [FAIL]
  Deep copy time:         0.0003 s
  Prune time:             0.22 s
psnr:  30.245467921665735
  Render time: 0.26s
  PSNR after pruning: 30.2455
  ΔPSNR after pruning: 0.5657 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Neighbor] pruning_rate=0.41, sh_rate=0.31, mem_score=1.048, ΔPSNR=0.5545 dB [FAIL]
  Deep copy time:         0.0004 s
  Prune time:             0.23 s
psnr:  30.256601987566267
  Render time: 0.26s
  PSNR after pruning: 30.2566
  ΔPSNR after pruning: 0.5545 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] Total configurations evaluated: 8

[Finalize] Running quantization for pruning_rate=0.41, sh_rate=0.30
  Deep copy time:         0.0003 s
  Prune time:             0.22 s
psnr:  30.292586462838308
  Render time: 45.24s
  PSNR after pruning: 30.2926
  ΔPSNR after pruning: 0.5185 dB
  Quantization breakdown -> prep_tensors: 0.000s, zero_mask_split: 0.001s, xyz_quant_morton: 0.006s, cpu_transfer: 0.107s, xyz_q16_encode: 0.235s, f_rest_int4: 1.293s, int8_pack: 0.962s
  Quantization time:      2.61 s
  Dequantization time:    1.09 s
  Estimated size:         25.68 MB
  Storage ratio vs input: 5.86%
[INFO] Storage breakdown:
    M_int8_compressed: 11.11 MB (43.26%)
    M_rest_compressed: 9.54 MB (37.14%)
    xyz_q16_compressed: 4.52 MB (17.61%)
    Z_rest: 175.83 KB (0.67%)
    S_rest: 175.83 KB (0.67%)
    Z_int8: 85.99 KB (0.33%)
    S_int8: 85.99 KB (0.33%)
    npz_path: 211.00 B (0.00%)
    int8_names: 131.00 B (0.00%)
    xyz_codec_used: 120.00 B (0.00%)
    compression_method: 120.00 B (0.00%)
    xyz_codec: 115.00 B (0.00%)
    xyz_q16_shape_uint16: 109.00 B (0.00%)
    xyz_q16_shape_bytes: 108.00 B (0.00%)
    xyz_q16_view_shape: 107.00 B (0.00%)
    M_rest_shape: 101.00 B (0.00%)
    M_int8_shape: 101.00 B (0.00%)
    int4_names: 99.00 B (0.00%)
    int2_names: 99.00 B (0.00%)
    fp16_names: 99.00 B (0.00%)
    segment_size_f_rest: 96.00 B (0.00%)
    use_entropy_coding: 95.00 B (0.00%)
    compression_level: 94.00 B (0.00%)
    boundary_index: 91.00 B (0.00%)
    num_segments: 89.00 B (0.00%)
    bits_f_rest: 88.00 B (0.00%)
    xyz_qbits: 86.00 B (0.00%)
    sh_all_zero: 84.00 B (0.00%)
    N_rest: 83.00 B (0.00%)
    N: 78.00 B (0.00%)
    xyz_mins: 69.00 B (0.00%)
    xyz_maxs: 69.00 B (0.00%)
psnr:  30.187163979666575
  Final render time:      45.14 s
  Final PSNR:             30.1872 dB
  ΔPSNR from input:       0.6240 dB

Search complete.

============================================================
Best combination found: pruning=0.410, sh=0.300

[INFO] Best config:           pruning_rate = 0.410, sh_rate = 0.300
[INFO] Base PSNR:             30.8111 dB
[INFO] Best PSNR:             30.1872 dB
[INFO] PSNR drop:             0.6240 dB
[INFO] Input file size:       438.10 MB
[INFO] Output file size:      25.68 MB
[INFO] Compression ratio:     17.06x
============================================================
 Saving render results ...
  Deep copy time:         0.0007 s
  Prune time:             0.22 s
psnr:  30.292586462838308
  Render time: 44.95s
  PSNR after pruning: 30.2926
  ΔPSNR after pruning: 0.5185 dB

============================================================
[STATS] Pipeline Time Breakdown:
  Load time:      8.95 s
  Score time:    11.52 s
  Search time:   98.37 s
  Store time:    45.23 s
  Total time:   164.06 s
============================================================
	Command being timed: "python /home/kemove/github/FlexGaussian/compress.py -s /home/kemove/data/mipnerf360/kitchen -m /home/kemove/data/3dgs-model/kitchen --output_path /home/kemove/efficient-output --quality_target_diff 0.55 --eval --compression_method zlib --compression_level 4 --xyz_codec morton16 --segments 1000 --use_importance_v4 True --topk_views_percent 0.1 --view_importance_weight 2.0 --save_render True"
	User time (seconds): 519.47
	System time (seconds): 16.42
	Percent of CPU this job got: 322%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 2:46.14
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 3877636
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 161
	Minor (reclaiming a frame) page faults: 1228461
	Voluntary context switches: 53958
	Involuntary context switches: 2323
	Swaps: 0
	File system inputs: 0
	File system outputs: 1008656
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
