Looking for config file in /home/kemove/data/3dgs-model/train/cfg_args
Config file found: /home/kemove/data/3dgs-model/train/cfg_args
[ARGS] Device: cuda
[ARGS] Input Model Path: /home/kemove/data/3dgs-model/train
[ARGS] Save Render: True
Reading camera 1/301Reading camera 2/301Reading camera 3/301Reading camera 4/301Reading camera 5/301Reading camera 6/301Reading camera 7/301Reading camera 8/301Reading camera 9/301Reading camera 10/301Reading camera 11/301Reading camera 12/301Reading camera 13/301Reading camera 14/301Reading camera 15/301Reading camera 16/301Reading camera 17/301Reading camera 18/301Reading camera 19/301Reading camera 20/301Reading camera 21/301Reading camera 22/301Reading camera 23/301Reading camera 24/301Reading camera 25/301Reading camera 26/301Reading camera 27/301Reading camera 28/301Reading camera 29/301Reading camera 30/301Reading camera 31/301Reading camera 32/301Reading camera 33/301Reading camera 34/301Reading camera 35/301Reading camera 36/301Reading camera 37/301Reading camera 38/301Reading camera 39/301Reading camera 40/301Reading camera 41/301Reading camera 42/301Reading camera 43/301Reading camera 44/301Reading camera 45/301Reading camera 46/301Reading camera 47/301Reading camera 48/301Reading camera 49/301Reading camera 50/301Reading camera 51/301Reading camera 52/301Reading camera 53/301Reading camera 54/301Reading camera 55/301Reading camera 56/301Reading camera 57/301Reading camera 58/301Reading camera 59/301Reading camera 60/301Reading camera 61/301Reading camera 62/301Reading camera 63/301Reading camera 64/301Reading camera 65/301Reading camera 66/301Reading camera 67/301Reading camera 68/301Reading camera 69/301Reading camera 70/301Reading camera 71/301Reading camera 72/301Reading camera 73/301Reading camera 74/301Reading camera 75/301Reading camera 76/301Reading camera 77/301Reading camera 78/301Reading camera 79/301Reading camera 80/301Reading camera 81/301Reading camera 82/301Reading camera 83/301Reading camera 84/301Reading camera 85/301Reading camera 86/301Reading camera 87/301Reading camera 88/301Reading camera 89/301Reading camera 90/301Reading camera 91/301Reading camera 92/301Reading camera 93/301Reading camera 94/301Reading camera 95/301Reading camera 96/301Reading camera 97/301Reading camera 98/301Reading camera 99/301Reading camera 100/301Reading camera 101/301Reading camera 102/301Reading camera 103/301Reading camera 104/301Reading camera 105/301Reading camera 106/301Reading camera 107/301Reading camera 108/301Reading camera 109/301Reading camera 110/301Reading camera 111/301Reading camera 112/301Reading camera 113/301Reading camera 114/301Reading camera 115/301Reading camera 116/301Reading camera 117/301Reading camera 118/301Reading camera 119/301Reading camera 120/301Reading camera 121/301Reading camera 122/301Reading camera 123/301Reading camera 124/301Reading camera 125/301Reading camera 126/301Reading camera 127/301Reading camera 128/301Reading camera 129/301Reading camera 130/301Reading camera 131/301Reading camera 132/301Reading camera 133/301Reading camera 134/301Reading camera 135/301Reading camera 136/301Reading camera 137/301Reading camera 138/301Reading camera 139/301Reading camera 140/301Reading camera 141/301Reading camera 142/301Reading camera 143/301Reading camera 144/301Reading camera 145/301Reading camera 146/301Reading camera 147/301Reading camera 148/301Reading camera 149/301Reading camera 150/301Reading camera 151/301Reading camera 152/301Reading camera 153/301Reading camera 154/301Reading camera 155/301Reading camera 156/301Reading camera 157/301Reading camera 158/301Reading camera 159/301Reading camera 160/301Reading camera 161/301Reading camera 162/301Reading camera 163/301Reading camera 164/301Reading camera 165/301Reading camera 166/301Reading camera 167/301Reading camera 168/301Reading camera 169/301Reading camera 170/301Reading camera 171/301Reading camera 172/301Reading camera 173/301Reading camera 174/301Reading camera 175/301Reading camera 176/301Reading camera 177/301Reading camera 178/301Reading camera 179/301Reading camera 180/301Reading camera 181/301Reading camera 182/301Reading camera 183/301Reading camera 184/301Reading camera 185/301Reading camera 186/301Reading camera 187/301Reading camera 188/301Reading camera 189/301Reading camera 190/301Reading camera 191/301Reading camera 192/301Reading camera 193/301Reading camera 194/301Reading camera 195/301Reading camera 196/301Reading camera 197/301Reading camera 198/301Reading camera 199/301Reading camera 200/301Reading camera 201/301Reading camera 202/301Reading camera 203/301Reading camera 204/301Reading camera 205/301Reading camera 206/301Reading camera 207/301Reading camera 208/301Reading camera 209/301Reading camera 210/301Reading camera 211/301Reading camera 212/301Reading camera 213/301Reading camera 214/301Reading camera 215/301Reading camera 216/301Reading camera 217/301Reading camera 218/301Reading camera 219/301Reading camera 220/301Reading camera 221/301Reading camera 222/301Reading camera 223/301Reading camera 224/301Reading camera 225/301Reading camera 226/301Reading camera 227/301Reading camera 228/301Reading camera 229/301Reading camera 230/301Reading camera 231/301Reading camera 232/301Reading camera 233/301Reading camera 234/301Reading camera 235/301Reading camera 236/301Reading camera 237/301Reading camera 238/301Reading camera 239/301Reading camera 240/301Reading camera 241/301Reading camera 242/301Reading camera 243/301Reading camera 244/301Reading camera 245/301Reading camera 246/301Reading camera 247/301Reading camera 248/301Reading camera 249/301Reading camera 250/301Reading camera 251/301Reading camera 252/301Reading camera 253/301Reading camera 254/301Reading camera 255/301Reading camera 256/301Reading camera 257/301Reading camera 258/301Reading camera 259/301Reading camera 260/301Reading camera 261/301Reading camera 262/301Reading camera 263/301Reading camera 264/301Reading camera 265/301Reading camera 266/301Reading camera 267/301Reading camera 268/301Reading camera 269/301Reading camera 270/301Reading camera 271/301Reading camera 272/301Reading camera 273/301Reading camera 274/301Reading camera 275/301Reading camera 276/301Reading camera 277/301Reading camera 278/301Reading camera 279/301Reading camera 280/301Reading camera 281/301Reading camera 282/301Reading camera 283/301Reading camera 284/301Reading camera 285/301Reading camera 286/301Reading camera 287/301Reading camera 288/301Reading camera 289/301Reading camera 290/301Reading camera 291/301Reading camera 292/301Reading camera 293/301Reading camera 294/301Reading camera 295/301Reading camera 296/301Reading camera 297/301Reading camera 298/301Reading camera 299/301Reading camera 300/301Reading camera 301/301
  Scene info loaded in 1.43 s
Loading Training Cameras
  Training cameras loaded in 2.38 s
Loading Test Cameras
  Test cameras loaded in 0.71 s
Loading PLY file...
  PLY file loaded in 1.33 s
[INFO] Computing importance scores...
[V4] Step 1: Evaluating view importance for all views...
[V3] Evaluating view importance for all 263 views...

[Overall] Importance contribution breakdown (averaged over 263 views):
  image_variance contribution: 0.947289 (0.56%)
  gradient_magnitude contribution: 1.249178 (0.74%)
  visibility_score contribution: 167.213045 (98.70%)
  Total importance: 169.409512
[V4] Using all 263 views, with top-26 (10.0%) important views weighted 2.0x
Computing importance (V4):   0%|          | 0/263 [00:00<?, ?it/s]Computing importance (V4):   2%|▏         | 6/263 [00:00<00:04, 56.38it/s]Computing importance (V4):   5%|▍         | 12/263 [00:00<00:04, 52.03it/s]Computing importance (V4):   7%|▋         | 18/263 [00:00<00:04, 50.40it/s]Computing importance (V4):   9%|▉         | 24/263 [00:00<00:04, 50.02it/s]Computing importance (V4):  11%|█▏        | 30/263 [00:00<00:04, 50.65it/s]Computing importance (V4):  14%|█▎        | 36/263 [00:00<00:04, 52.82it/s]Computing importance (V4):  16%|█▌        | 42/263 [00:00<00:04, 52.01it/s]Computing importance (V4):  18%|█▊        | 48/263 [00:00<00:04, 53.28it/s]Computing importance (V4):  21%|██        | 54/263 [00:01<00:04, 51.70it/s]Computing importance (V4):  23%|██▎       | 60/263 [00:01<00:03, 51.83it/s]Computing importance (V4):  25%|██▌       | 66/263 [00:01<00:03, 51.80it/s]Computing importance (V4):  27%|██▋       | 72/263 [00:01<00:03, 52.77it/s]Computing importance (V4):  30%|██▉       | 78/263 [00:01<00:03, 53.87it/s]Computing importance (V4):  32%|███▏      | 84/263 [00:01<00:03, 55.23it/s]Computing importance (V4):  34%|███▍      | 90/263 [00:01<00:03, 55.71it/s]Computing importance (V4):  37%|███▋      | 96/263 [00:01<00:03, 55.66it/s]Computing importance (V4):  39%|███▉      | 102/263 [00:01<00:02, 55.74it/s]Computing importance (V4):  41%|████      | 108/263 [00:02<00:02, 53.71it/s]Computing importance (V4):  43%|████▎     | 114/263 [00:02<00:02, 54.59it/s]Computing importance (V4):  46%|████▌     | 120/263 [00:02<00:02, 53.53it/s]Computing importance (V4):  48%|████▊     | 126/263 [00:02<00:02, 54.57it/s]Computing importance (V4):  50%|█████     | 132/263 [00:02<00:02, 51.94it/s]Computing importance (V4):  52%|█████▏    | 138/263 [00:02<00:02, 53.48it/s]Computing importance (V4):  55%|█████▍    | 144/263 [00:02<00:02, 53.72it/s]Computing importance (V4):  57%|█████▋    | 150/263 [00:02<00:02, 52.70it/s]Computing importance (V4):  59%|█████▉    | 156/263 [00:02<00:01, 54.22it/s]Computing importance (V4):  62%|██████▏   | 162/263 [00:03<00:01, 52.84it/s]Computing importance (V4):  64%|██████▍   | 168/263 [00:03<00:01, 53.60it/s]Computing importance (V4):  66%|██████▌   | 174/263 [00:03<00:01, 53.40it/s]Computing importance (V4):  68%|██████▊   | 180/263 [00:03<00:01, 55.18it/s]Computing importance (V4):  71%|███████   | 186/263 [00:03<00:01, 54.59it/s]Computing importance (V4):  73%|███████▎  | 192/263 [00:03<00:01, 52.97it/s]Computing importance (V4):  75%|███████▌  | 198/263 [00:03<00:01, 53.01it/s]Computing importance (V4):  78%|███████▊  | 204/263 [00:03<00:01, 53.11it/s]Computing importance (V4):  80%|███████▉  | 210/263 [00:03<00:01, 52.09it/s]Computing importance (V4):  82%|████████▏ | 216/263 [00:04<00:00, 52.51it/s]Computing importance (V4):  84%|████████▍ | 222/263 [00:04<00:00, 52.78it/s]Computing importance (V4):  87%|████████▋ | 228/263 [00:04<00:00, 52.67it/s]Computing importance (V4):  89%|████████▉ | 234/263 [00:04<00:00, 53.83it/s]Computing importance (V4):  91%|█████████▏| 240/263 [00:04<00:00, 51.39it/s]Computing importance (V4):  94%|█████████▎| 246/263 [00:04<00:00, 53.17it/s]Computing importance (V4):  96%|█████████▌| 252/263 [00:04<00:00, 52.74it/s]Computing importance (V4):  98%|█████████▊| 258/263 [00:04<00:00, 53.44it/s]Computing importance (V4): 100%|██████████| 263/263 [00:04<00:00, 53.17it/s]

[V4] Gradient Component Statistics (Mean Values):
--------------------------------------------------
Component          Raw Value   Relative %
--------------------------------------------------
xyz                 0.000025       84.44%
scaling             0.000001        2.39%
rotation            0.000002        5.66%
dc                  0.000000        1.39%
sh                  0.000002        5.40%
opacity             0.000000        0.72%
--------------------------------------------------

[V4] Weighted Gradient Contributions:
--------------------------------------------------
Component         Weight    Contrib %
--------------------------------------------------
xyz                 0.02       25.99%
scaling             1.00       36.72%
rotation            0.20       17.43%
dc                  0.10        2.14%
sh                  0.20       16.61%
opacity             0.10        1.11%
--------------------------------------------------

[Baseline] ...
psnr:  21.77686239543714
  Baseline render time:   0.23 s
  Baseline PSNR:          21.7769 dB

[Search] [Seed] pruning_rate=0.70, sh_rate=0.20, mem_score=1.460, ΔPSNR=1.2456 dB [FAIL]
  Deep copy time:         0.0006 s
  Prune time:             0.12 s
psnr:  20.531237602233887
  Render time: 0.14s
  PSNR after pruning: 20.5312
  ΔPSNR after pruning: 1.2456 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Seed] pruning_rate=0.60, sh_rate=0.30, mem_score=1.380, ΔPSNR=0.8148 dB [FAIL]
  Deep copy time:         0.0003 s
  Prune time:             0.12 s
psnr:  20.962050111670244
  Render time: 0.15s
  PSNR after pruning: 20.9621
  ΔPSNR after pruning: 0.8148 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Seed] pruning_rate=0.40, sh_rate=0.50, mem_score=1.220, ΔPSNR=0.5191 dB [OK]
  Deep copy time:         0.0003 s
  Prune time:             0.12 s
psnr:  21.257773851093493
  Render time: 0.18s
  PSNR after pruning: 21.2578
  ΔPSNR after pruning: 0.5191 dB
  [INFO] New best config: mem_score=1.220, ΔPSNR=0.5191 dB

[Search] [Neighbor] pruning_rate=0.41, sh_rate=0.50, mem_score=1.238, ΔPSNR=0.5648 dB [FAIL]
  Deep copy time:         0.0003 s
  Prune time:             0.12 s
psnr:  21.212040349056846
  Render time: 0.18s
  PSNR after pruning: 21.2120
  ΔPSNR after pruning: 0.5648 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Neighbor] pruning_rate=0.40, sh_rate=0.51, mem_score=1.230, ΔPSNR=0.5596 dB [FAIL]
  Deep copy time:         0.0003 s
  Prune time:             0.12 s
psnr:  21.217214107513428
  Render time: 0.18s
  PSNR after pruning: 21.2172
  ΔPSNR after pruning: 0.5596 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] Total configurations evaluated: 5

[Finalize] Running quantization for pruning_rate=0.40, sh_rate=0.50
  Deep copy time:         0.0003 s
  Prune time:             0.12 s
psnr:  21.257773851093493
  Render time: 16.09s
  PSNR after pruning: 21.2578
  ΔPSNR after pruning: 0.5191 dB
  Quantization breakdown -> prep_tensors: 0.000s, zero_mask_split: 0.001s, xyz_quant_morton: 0.006s, cpu_transfer: 0.029s, xyz_q16_encode: 0.144s, f_rest_int4: 0.622s, int8_pack: 0.716s
  Quantization time:      1.52 s
  Dequantization time:    0.76 s
  Estimated size:         11.37 MB
  Storage ratio vs input: 4.68%
[INFO] Storage breakdown:
    M_int8_compressed: 6.37 MB (56.00%)
    xyz_q16_compressed: 2.57 MB (22.58%)
    M_rest_compressed: 1.92 MB (16.90%)
    Z_rest: 175.83 KB (1.51%)
    S_rest: 175.83 KB (1.51%)
    Z_int8: 85.99 KB (0.74%)
    S_int8: 85.99 KB (0.74%)
    npz_path: 209.00 B (0.00%)
    int8_names: 131.00 B (0.00%)
    xyz_codec_used: 120.00 B (0.00%)
    compression_method: 120.00 B (0.00%)
    xyz_codec: 115.00 B (0.00%)
    xyz_q16_shape_uint16: 109.00 B (0.00%)
    xyz_q16_shape_bytes: 108.00 B (0.00%)
    xyz_q16_view_shape: 107.00 B (0.00%)
    M_rest_shape: 101.00 B (0.00%)
    M_int8_shape: 101.00 B (0.00%)
    int4_names: 99.00 B (0.00%)
    int2_names: 99.00 B (0.00%)
    fp16_names: 99.00 B (0.00%)
    segment_size_f_rest: 96.00 B (0.00%)
    use_entropy_coding: 95.00 B (0.00%)
    compression_level: 94.00 B (0.00%)
    boundary_index: 91.00 B (0.00%)
    num_segments: 89.00 B (0.00%)
    bits_f_rest: 88.00 B (0.00%)
    xyz_qbits: 86.00 B (0.00%)
    sh_all_zero: 84.00 B (0.00%)
    N_rest: 83.00 B (0.00%)
    N: 78.00 B (0.00%)
    xyz_mins: 69.00 B (0.00%)
    xyz_maxs: 69.00 B (0.00%)
psnr:  21.215468231000397
  Final render time:      15.96 s
  Final PSNR:             21.2155 dB
  ΔPSNR from input:       0.5614 dB

Search complete.

============================================================
Best combination found: pruning=0.400, sh=0.500

[INFO] Best config:           pruning_rate = 0.400, sh_rate = 0.500
[INFO] Base PSNR:             21.7769 dB
[INFO] Best PSNR:             21.2155 dB
[INFO] PSNR drop:             0.5614 dB
[INFO] Input file size:       242.78 MB
[INFO] Output file size:      11.37 MB
[INFO] Compression ratio:     21.36x
============================================================
 Saving render results ...
  Deep copy time:         0.0006 s
  Prune time:             0.12 s
psnr:  21.257773851093493
  Render time: 15.96s
  PSNR after pruning: 21.2578
  ΔPSNR after pruning: 0.5191 dB

============================================================
[STATS] Pipeline Time Breakdown:
  Load time:      5.86 s
  Score time:     7.42 s
  Search time:   36.13 s
  Store time:    16.11 s
  Total time:    65.52 s
============================================================
	Command being timed: "python /home/kemove/github/FlexGaussian/compress.py -s /home/kemove/data/tandt/train -m /home/kemove/data/3dgs-model/train --output_path /home/kemove/efficient-output --quality_target_diff 0.55 --eval --compression_method zlib --compression_level 4 --xyz_codec morton16 --segments 1000 --use_importance_v4 True --topk_views_percent 0.1 --view_importance_weight 2.0 --save_render True"
	User time (seconds): 378.57
	System time (seconds): 10.81
	Percent of CPU this job got: 576%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:07.51
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 3281400
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 140
	Minor (reclaiming a frame) page faults: 838005
	Voluntary context switches: 55126
	Involuntary context switches: 1846
	Swaps: 0
	File system inputs: 0
	File system outputs: 377104
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
