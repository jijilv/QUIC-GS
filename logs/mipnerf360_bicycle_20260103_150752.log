Looking for config file in /home/kemove/data/3dgs-model/bicycle/cfg_args
Config file found: /home/kemove/data/3dgs-model/bicycle/cfg_args
[ARGS] Device: cuda
[ARGS] Input Model Path: /home/kemove/data/3dgs-model/bicycle
[ARGS] Save Render: True
Reading camera 1/194Reading camera 2/194Reading camera 3/194Reading camera 4/194Reading camera 5/194Reading camera 6/194Reading camera 7/194Reading camera 8/194Reading camera 9/194Reading camera 10/194Reading camera 11/194Reading camera 12/194Reading camera 13/194Reading camera 14/194Reading camera 15/194Reading camera 16/194Reading camera 17/194Reading camera 18/194Reading camera 19/194Reading camera 20/194Reading camera 21/194Reading camera 22/194Reading camera 23/194Reading camera 24/194Reading camera 25/194Reading camera 26/194Reading camera 27/194Reading camera 28/194Reading camera 29/194Reading camera 30/194Reading camera 31/194Reading camera 32/194Reading camera 33/194Reading camera 34/194Reading camera 35/194Reading camera 36/194Reading camera 37/194Reading camera 38/194Reading camera 39/194Reading camera 40/194Reading camera 41/194Reading camera 42/194Reading camera 43/194Reading camera 44/194Reading camera 45/194Reading camera 46/194Reading camera 47/194Reading camera 48/194Reading camera 49/194Reading camera 50/194Reading camera 51/194Reading camera 52/194Reading camera 53/194Reading camera 54/194Reading camera 55/194Reading camera 56/194Reading camera 57/194Reading camera 58/194Reading camera 59/194Reading camera 60/194Reading camera 61/194Reading camera 62/194Reading camera 63/194Reading camera 64/194Reading camera 65/194Reading camera 66/194Reading camera 67/194Reading camera 68/194Reading camera 69/194Reading camera 70/194Reading camera 71/194Reading camera 72/194Reading camera 73/194Reading camera 74/194Reading camera 75/194Reading camera 76/194Reading camera 77/194Reading camera 78/194Reading camera 79/194Reading camera 80/194Reading camera 81/194Reading camera 82/194Reading camera 83/194Reading camera 84/194Reading camera 85/194Reading camera 86/194Reading camera 87/194Reading camera 88/194Reading camera 89/194Reading camera 90/194Reading camera 91/194Reading camera 92/194Reading camera 93/194Reading camera 94/194Reading camera 95/194Reading camera 96/194Reading camera 97/194Reading camera 98/194Reading camera 99/194Reading camera 100/194Reading camera 101/194Reading camera 102/194Reading camera 103/194Reading camera 104/194Reading camera 105/194Reading camera 106/194Reading camera 107/194Reading camera 108/194Reading camera 109/194Reading camera 110/194Reading camera 111/194Reading camera 112/194Reading camera 113/194Reading camera 114/194Reading camera 115/194Reading camera 116/194Reading camera 117/194Reading camera 118/194Reading camera 119/194Reading camera 120/194Reading camera 121/194Reading camera 122/194Reading camera 123/194Reading camera 124/194Reading camera 125/194Reading camera 126/194Reading camera 127/194Reading camera 128/194Reading camera 129/194Reading camera 130/194Reading camera 131/194Reading camera 132/194Reading camera 133/194Reading camera 134/194Reading camera 135/194Reading camera 136/194Reading camera 137/194Reading camera 138/194Reading camera 139/194Reading camera 140/194Reading camera 141/194Reading camera 142/194Reading camera 143/194Reading camera 144/194Reading camera 145/194Reading camera 146/194Reading camera 147/194Reading camera 148/194Reading camera 149/194Reading camera 150/194Reading camera 151/194Reading camera 152/194Reading camera 153/194Reading camera 154/194Reading camera 155/194Reading camera 156/194Reading camera 157/194Reading camera 158/194Reading camera 159/194Reading camera 160/194Reading camera 161/194Reading camera 162/194Reading camera 163/194Reading camera 164/194Reading camera 165/194Reading camera 166/194Reading camera 167/194Reading camera 168/194Reading camera 169/194Reading camera 170/194Reading camera 171/194Reading camera 172/194Reading camera 173/194Reading camera 174/194Reading camera 175/194Reading camera 176/194Reading camera 177/194Reading camera 178/194Reading camera 179/194Reading camera 180/194Reading camera 181/194Reading camera 182/194Reading camera 183/194Reading camera 184/194Reading camera 185/194Reading camera 186/194Reading camera 187/194Reading camera 188/194Reading camera 189/194Reading camera 190/194Reading camera 191/194Reading camera 192/194Reading camera 193/194Reading camera 194/194
  Scene info loaded in 1.00 s
Loading Training Cameras
  Training cameras loaded in 2.41 s
Loading Test Cameras
  Test cameras loaded in 0.87 s
Loading PLY file...
  PLY file loaded in 8.18 s
[INFO] Computing importance scores...
[V4] Step 1: Evaluating view importance for all views...
[V3] Evaluating view importance for all 169 views...

[Overall] Importance contribution breakdown (averaged over 169 views):
  image_variance contribution: 0.454291 (1.15%)
  gradient_magnitude contribution: 1.110486 (2.81%)
  visibility_score contribution: 37.886430 (96.03%)
  Total importance: 39.451206
[V4] Using all 169 views, with top-16 (10.0%) important views weighted 2.0x
Computing importance (V4):   0%|          | 0/169 [00:00<?, ?it/s]Computing importance (V4):   2%|▏         | 3/169 [00:00<00:06, 26.69it/s]Computing importance (V4):   4%|▎         | 6/169 [00:00<00:06, 24.53it/s]Computing importance (V4):   5%|▌         | 9/169 [00:00<00:06, 23.97it/s]Computing importance (V4):   7%|▋         | 12/169 [00:00<00:06, 24.49it/s]Computing importance (V4):   9%|▉         | 15/169 [00:00<00:06, 23.96it/s]Computing importance (V4):  11%|█         | 18/169 [00:00<00:06, 23.06it/s]Computing importance (V4):  12%|█▏        | 21/169 [00:00<00:06, 23.13it/s]Computing importance (V4):  14%|█▍        | 24/169 [00:01<00:06, 23.59it/s]Computing importance (V4):  16%|█▌        | 27/169 [00:01<00:06, 23.56it/s]Computing importance (V4):  18%|█▊        | 30/169 [00:01<00:05, 23.72it/s]Computing importance (V4):  20%|█▉        | 33/169 [00:01<00:05, 23.20it/s]Computing importance (V4):  21%|██▏       | 36/169 [00:01<00:05, 24.00it/s]Computing importance (V4):  23%|██▎       | 39/169 [00:01<00:05, 24.44it/s]Computing importance (V4):  25%|██▍       | 42/169 [00:01<00:05, 24.64it/s]Computing importance (V4):  27%|██▋       | 45/169 [00:01<00:05, 23.90it/s]Computing importance (V4):  28%|██▊       | 48/169 [00:02<00:05, 23.57it/s]Computing importance (V4):  30%|███       | 51/169 [00:02<00:04, 23.62it/s]Computing importance (V4):  32%|███▏      | 54/169 [00:02<00:04, 23.50it/s]Computing importance (V4):  34%|███▎      | 57/169 [00:02<00:04, 23.63it/s]Computing importance (V4):  36%|███▌      | 60/169 [00:02<00:04, 23.84it/s]Computing importance (V4):  37%|███▋      | 63/169 [00:02<00:04, 23.64it/s]Computing importance (V4):  39%|███▉      | 66/169 [00:02<00:04, 23.09it/s]Computing importance (V4):  41%|████      | 69/169 [00:02<00:04, 23.48it/s]Computing importance (V4):  43%|████▎     | 72/169 [00:03<00:04, 23.57it/s]Computing importance (V4):  44%|████▍     | 75/169 [00:03<00:03, 24.08it/s]Computing importance (V4):  46%|████▌     | 78/169 [00:03<00:03, 24.26it/s]Computing importance (V4):  48%|████▊     | 81/169 [00:03<00:03, 23.74it/s]Computing importance (V4):  50%|████▉     | 84/169 [00:03<00:03, 23.89it/s]Computing importance (V4):  51%|█████▏    | 87/169 [00:03<00:03, 24.00it/s]Computing importance (V4):  53%|█████▎    | 90/169 [00:03<00:03, 24.10it/s]Computing importance (V4):  55%|█████▌    | 93/169 [00:03<00:03, 24.10it/s]Computing importance (V4):  57%|█████▋    | 96/169 [00:04<00:03, 23.81it/s]Computing importance (V4):  59%|█████▊    | 99/169 [00:04<00:02, 23.46it/s]Computing importance (V4):  60%|██████    | 102/169 [00:04<00:02, 24.24it/s]Computing importance (V4):  62%|██████▏   | 105/169 [00:04<00:02, 23.78it/s]Computing importance (V4):  64%|██████▍   | 108/169 [00:04<00:02, 23.71it/s]Computing importance (V4):  66%|██████▌   | 111/169 [00:04<00:02, 23.63it/s]Computing importance (V4):  67%|██████▋   | 114/169 [00:04<00:02, 22.92it/s]Computing importance (V4):  69%|██████▉   | 117/169 [00:04<00:02, 23.57it/s]Computing importance (V4):  71%|███████   | 120/169 [00:05<00:02, 24.14it/s]Computing importance (V4):  73%|███████▎  | 123/169 [00:05<00:01, 24.04it/s]Computing importance (V4):  75%|███████▍  | 126/169 [00:05<00:01, 24.29it/s]Computing importance (V4):  76%|███████▋  | 129/169 [00:05<00:01, 23.59it/s]Computing importance (V4):  78%|███████▊  | 132/169 [00:05<00:01, 23.10it/s]Computing importance (V4):  80%|███████▉  | 135/169 [00:05<00:01, 22.77it/s]Computing importance (V4):  82%|████████▏ | 138/169 [00:05<00:01, 23.15it/s]Computing importance (V4):  83%|████████▎ | 141/169 [00:05<00:01, 23.22it/s]Computing importance (V4):  85%|████████▌ | 144/169 [00:06<00:01, 23.21it/s]Computing importance (V4):  87%|████████▋ | 147/169 [00:06<00:00, 23.13it/s]Computing importance (V4):  89%|████████▉ | 150/169 [00:06<00:00, 23.34it/s]Computing importance (V4):  91%|█████████ | 153/169 [00:06<00:00, 23.45it/s]Computing importance (V4):  92%|█████████▏| 156/169 [00:06<00:00, 23.74it/s]Computing importance (V4):  94%|█████████▍| 159/169 [00:06<00:00, 23.89it/s]Computing importance (V4):  96%|█████████▌| 162/169 [00:06<00:00, 22.90it/s]Computing importance (V4):  98%|█████████▊| 165/169 [00:06<00:00, 23.38it/s]Computing importance (V4):  99%|█████████▉| 168/169 [00:07<00:00, 23.35it/s]Computing importance (V4): 100%|██████████| 169/169 [00:07<00:00, 23.65it/s]

[V4] Gradient Component Statistics (Mean Values):
--------------------------------------------------
Component          Raw Value   Relative %
--------------------------------------------------
xyz                 0.000004       86.54%
scaling             0.000000        1.44%
rotation            0.000000        4.37%
dc                  0.000000        1.46%
sh                  0.000000        5.64%
opacity             0.000000        0.56%
--------------------------------------------------

[V4] Weighted Gradient Contributions:
--------------------------------------------------
Component         Weight    Contrib %
--------------------------------------------------
xyz                 0.02       32.23%
scaling             1.00       26.75%
rotation            0.20       16.28%
dc                  0.10        2.71%
sh                  0.20       20.99%
opacity             0.10        1.05%
--------------------------------------------------

[Baseline] ...
psnr:  25.1758097076416
  Baseline render time:   0.39 s
  Baseline PSNR:          25.1758 dB

[Search] [Seed] pruning_rate=0.70, sh_rate=0.20, mem_score=1.460, ΔPSNR=0.5603 dB [FAIL]
  Deep copy time:         0.0007 s
  Prune time:             0.73 s
psnr:  24.615484466552733
  Render time: 0.19s
  PSNR after pruning: 24.6155
  ΔPSNR after pruning: 0.5603 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Seed] pruning_rate=0.60, sh_rate=0.30, mem_score=1.380, ΔPSNR=0.3424 dB [OK]
  Deep copy time:         0.0003 s
  Prune time:             0.73 s
psnr:  24.833422546386718
  Render time: 0.22s
  PSNR after pruning: 24.8334
  ΔPSNR after pruning: 0.3424 dB
  [INFO] New best config: mem_score=1.380, ΔPSNR=0.3424 dB

[Search] [Neighbor] pruning_rate=0.62, sh_rate=0.30, mem_score=1.416, ΔPSNR=0.4422 dB [OK]
  Deep copy time:         0.0003 s
  Prune time:             0.74 s
psnr:  24.73363800048828
  Render time: 0.22s
  PSNR after pruning: 24.7336
  ΔPSNR after pruning: 0.4422 dB
  [INFO] New best config: mem_score=1.416, ΔPSNR=0.4422 dB
  [INFO] Queue cleanup: removed 1 low mem_score configs (queue: 3 -> 2)

[Search] [Neighbor] pruning_rate=0.63, sh_rate=0.30, mem_score=1.434, ΔPSNR=0.5025 dB [OK]
  Deep copy time:         0.0003 s
  Prune time:             0.74 s
psnr:  24.67328796386719
  Render time: 0.21s
  PSNR after pruning: 24.6733
  ΔPSNR after pruning: 0.5025 dB
  [INFO] New best config: mem_score=1.434, ΔPSNR=0.5025 dB
  [INFO] Queue cleanup: removed 1 low mem_score configs (queue: 3 -> 2)

[Search] [Neighbor] pruning_rate=0.64, sh_rate=0.30, mem_score=1.452, ΔPSNR=0.5728 dB [FAIL]
  Deep copy time:         0.0003 s
  Prune time:             0.73 s
psnr:  24.60303207397461
  Render time: 0.21s
  PSNR after pruning: 24.6030
  ΔPSNR after pruning: 0.5728 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Neighbor] pruning_rate=0.63, sh_rate=0.31, mem_score=1.444, ΔPSNR=0.5576 dB [FAIL]
  Deep copy time:         0.0003 s
  Prune time:             0.76 s
psnr:  24.61816795349121
  Render time: 0.21s
  PSNR after pruning: 24.6182
  ΔPSNR after pruning: 0.5576 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] Total configurations evaluated: 6

[Finalize] Running quantization for pruning_rate=0.63, sh_rate=0.30
  Deep copy time:         0.0003 s
  Prune time:             0.73 s
psnr:  24.67328796386719
  Render time: 16.68s
  PSNR after pruning: 24.6733
  ΔPSNR after pruning: 0.5025 dB
  Quantization breakdown -> prep_tensors: 0.000s, zero_mask_split: 0.003s, xyz_quant_morton: 0.006s, cpu_transfer: 0.138s, xyz_q16_encode: 0.560s, f_rest_int4: 1.050s, int8_pack: 1.510s
  Quantization time:      3.27 s
  Dequantization time:    1.34 s
  Estimated size:         40.92 MB
  Storage ratio vs input: 2.82%
[INFO] Storage breakdown:
    M_int8_compressed: 23.42 MB (57.22%)
    xyz_q16_compressed: 9.88 MB (24.14%)
    M_rest_compressed: 7.11 MB (17.38%)
    Z_rest: 175.83 KB (0.42%)
    S_rest: 175.83 KB (0.42%)
    Z_int8: 85.99 KB (0.21%)
    S_int8: 85.99 KB (0.21%)
    npz_path: 211.00 B (0.00%)
    int8_names: 131.00 B (0.00%)
    xyz_codec_used: 120.00 B (0.00%)
    compression_method: 120.00 B (0.00%)
    xyz_codec: 115.00 B (0.00%)
    xyz_q16_shape_uint16: 109.00 B (0.00%)
    xyz_q16_shape_bytes: 108.00 B (0.00%)
    xyz_q16_view_shape: 107.00 B (0.00%)
    M_rest_shape: 101.00 B (0.00%)
    M_int8_shape: 101.00 B (0.00%)
    int4_names: 99.00 B (0.00%)
    int2_names: 99.00 B (0.00%)
    fp16_names: 99.00 B (0.00%)
    segment_size_f_rest: 96.00 B (0.00%)
    use_entropy_coding: 95.00 B (0.00%)
    compression_level: 94.00 B (0.00%)
    boundary_index: 91.00 B (0.00%)
    num_segments: 89.00 B (0.00%)
    bits_f_rest: 88.00 B (0.00%)
    xyz_qbits: 86.00 B (0.00%)
    sh_all_zero: 84.00 B (0.00%)
    N_rest: 83.00 B (0.00%)
    N: 78.00 B (0.00%)
    xyz_mins: 69.00 B (0.00%)
    xyz_maxs: 69.00 B (0.00%)
psnr:  24.492829666137695
  Final render time:      16.45 s
  Final PSNR:             24.4928 dB
  ΔPSNR from input:       0.6830 dB

Search complete.

============================================================
Best combination found: pruning=0.630, sh=0.300

[INFO] Best config:           pruning_rate = 0.630, sh_rate = 0.300
[INFO] Base PSNR:             25.1758 dB
[INFO] Best PSNR:             24.4928 dB
[INFO] PSNR drop:             0.6830 dB
[INFO] Input file size:       1450.28 MB
[INFO] Output file size:      40.92 MB
[INFO] Compression ratio:     35.44x
============================================================
 Saving render results ...
  Deep copy time:         0.0007 s
  Prune time:             0.73 s
psnr:  24.67328796386719
  Render time: 16.53s
  PSNR after pruning: 24.6733
  ΔPSNR after pruning: 0.5025 dB

============================================================
[STATS] Pipeline Time Breakdown:
  Load time:     12.46 s
  Score time:    10.14 s
  Search time:   44.57 s
  Store time:    17.39 s
  Total time:    84.57 s
============================================================
	Command being timed: "python /home/kemove/github/FlexGaussian/compress.py -s /home/kemove/data/mipnerf360/bicycle -m /home/kemove/data/3dgs-model/bicycle --output_path /home/kemove/efficient-output --quality_target_diff 0.55 --eval --compression_method zlib --compression_level 4 --xyz_codec morton16 --segments 1000 --use_importance_v4 True --topk_views_percent 0.1 --view_importance_weight 2.0 --save_render True"
	User time (seconds): 329.18
	System time (seconds): 15.93
	Percent of CPU this job got: 398%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:26.58
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 5746888
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 137
	Minor (reclaiming a frame) page faults: 1733210
	Voluntary context switches: 51465
	Involuntary context switches: 1724
	Swaps: 0
	File system inputs: 0
	File system outputs: 636848
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
