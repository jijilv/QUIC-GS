Looking for config file in /home/kemove/data/3dgs-model/drjohnson/cfg_args
Config file found: /home/kemove/data/3dgs-model/drjohnson/cfg_args
[ARGS] Device: cuda
[ARGS] Input Model Path: /home/kemove/data/3dgs-model/drjohnson
[ARGS] Save Render: True
Reading camera 1/263Reading camera 2/263Reading camera 3/263Reading camera 4/263Reading camera 5/263Reading camera 6/263Reading camera 7/263Reading camera 8/263Reading camera 9/263Reading camera 10/263Reading camera 11/263Reading camera 12/263Reading camera 13/263Reading camera 14/263Reading camera 15/263Reading camera 16/263Reading camera 17/263Reading camera 18/263Reading camera 19/263Reading camera 20/263Reading camera 21/263Reading camera 22/263Reading camera 23/263Reading camera 24/263Reading camera 25/263Reading camera 26/263Reading camera 27/263Reading camera 28/263Reading camera 29/263Reading camera 30/263Reading camera 31/263Reading camera 32/263Reading camera 33/263Reading camera 34/263Reading camera 35/263Reading camera 36/263Reading camera 37/263Reading camera 38/263Reading camera 39/263Reading camera 40/263Reading camera 41/263Reading camera 42/263Reading camera 43/263Reading camera 44/263Reading camera 45/263Reading camera 46/263Reading camera 47/263Reading camera 48/263Reading camera 49/263Reading camera 50/263Reading camera 51/263Reading camera 52/263Reading camera 53/263Reading camera 54/263Reading camera 55/263Reading camera 56/263Reading camera 57/263Reading camera 58/263Reading camera 59/263Reading camera 60/263Reading camera 61/263Reading camera 62/263Reading camera 63/263Reading camera 64/263Reading camera 65/263Reading camera 66/263Reading camera 67/263Reading camera 68/263Reading camera 69/263Reading camera 70/263Reading camera 71/263Reading camera 72/263Reading camera 73/263Reading camera 74/263Reading camera 75/263Reading camera 76/263Reading camera 77/263Reading camera 78/263Reading camera 79/263Reading camera 80/263Reading camera 81/263Reading camera 82/263Reading camera 83/263Reading camera 84/263Reading camera 85/263Reading camera 86/263Reading camera 87/263Reading camera 88/263Reading camera 89/263Reading camera 90/263Reading camera 91/263Reading camera 92/263Reading camera 93/263Reading camera 94/263Reading camera 95/263Reading camera 96/263Reading camera 97/263Reading camera 98/263Reading camera 99/263Reading camera 100/263Reading camera 101/263Reading camera 102/263Reading camera 103/263Reading camera 104/263Reading camera 105/263Reading camera 106/263Reading camera 107/263Reading camera 108/263Reading camera 109/263Reading camera 110/263Reading camera 111/263Reading camera 112/263Reading camera 113/263Reading camera 114/263Reading camera 115/263Reading camera 116/263Reading camera 117/263Reading camera 118/263Reading camera 119/263Reading camera 120/263Reading camera 121/263Reading camera 122/263Reading camera 123/263Reading camera 124/263Reading camera 125/263Reading camera 126/263Reading camera 127/263Reading camera 128/263Reading camera 129/263Reading camera 130/263Reading camera 131/263Reading camera 132/263Reading camera 133/263Reading camera 134/263Reading camera 135/263Reading camera 136/263Reading camera 137/263Reading camera 138/263Reading camera 139/263Reading camera 140/263Reading camera 141/263Reading camera 142/263Reading camera 143/263Reading camera 144/263Reading camera 145/263Reading camera 146/263Reading camera 147/263Reading camera 148/263Reading camera 149/263Reading camera 150/263Reading camera 151/263Reading camera 152/263Reading camera 153/263Reading camera 154/263Reading camera 155/263Reading camera 156/263Reading camera 157/263Reading camera 158/263Reading camera 159/263Reading camera 160/263Reading camera 161/263Reading camera 162/263Reading camera 163/263Reading camera 164/263Reading camera 165/263Reading camera 166/263Reading camera 167/263Reading camera 168/263Reading camera 169/263Reading camera 170/263Reading camera 171/263Reading camera 172/263Reading camera 173/263Reading camera 174/263Reading camera 175/263Reading camera 176/263Reading camera 177/263Reading camera 178/263Reading camera 179/263Reading camera 180/263Reading camera 181/263Reading camera 182/263Reading camera 183/263Reading camera 184/263Reading camera 185/263Reading camera 186/263Reading camera 187/263Reading camera 188/263Reading camera 189/263Reading camera 190/263Reading camera 191/263Reading camera 192/263Reading camera 193/263Reading camera 194/263Reading camera 195/263Reading camera 196/263Reading camera 197/263Reading camera 198/263Reading camera 199/263Reading camera 200/263Reading camera 201/263Reading camera 202/263Reading camera 203/263Reading camera 204/263Reading camera 205/263Reading camera 206/263Reading camera 207/263Reading camera 208/263Reading camera 209/263Reading camera 210/263Reading camera 211/263Reading camera 212/263Reading camera 213/263Reading camera 214/263Reading camera 215/263Reading camera 216/263Reading camera 217/263Reading camera 218/263Reading camera 219/263Reading camera 220/263Reading camera 221/263Reading camera 222/263Reading camera 223/263Reading camera 224/263Reading camera 225/263Reading camera 226/263Reading camera 227/263Reading camera 228/263Reading camera 229/263Reading camera 230/263Reading camera 231/263Reading camera 232/263Reading camera 233/263Reading camera 234/263Reading camera 235/263Reading camera 236/263Reading camera 237/263Reading camera 238/263Reading camera 239/263Reading camera 240/263Reading camera 241/263Reading camera 242/263Reading camera 243/263Reading camera 244/263Reading camera 245/263Reading camera 246/263Reading camera 247/263Reading camera 248/263Reading camera 249/263Reading camera 250/263Reading camera 251/263Reading camera 252/263Reading camera 253/263Reading camera 254/263Reading camera 255/263Reading camera 256/263Reading camera 257/263Reading camera 258/263Reading camera 259/263Reading camera 260/263Reading camera 261/263Reading camera 262/263Reading camera 263/263
  Scene info loaded in 0.80 s
Loading Training Cameras
  Training cameras loaded in 3.22 s
Loading Test Cameras
  Test cameras loaded in 1.13 s
Loading PLY file...
  PLY file loaded in 4.54 s
[INFO] Computing importance scores...
[V4] Step 1: Evaluating view importance for all views...
[V3] Evaluating view importance for all 230 views...

[Overall] Importance contribution breakdown (averaged over 230 views):
  image_variance contribution: 0.346761 (1.12%)
  gradient_magnitude contribution: 0.335234 (1.08%)
  visibility_score contribution: 30.333103 (97.80%)
  Total importance: 31.015098
[V4] Using all 230 views, with top-23 (10.0%) important views weighted 2.0x
Computing importance (V4):   0%|          | 0/230 [00:00<?, ?it/s]Computing importance (V4):   1%|▏         | 3/230 [00:00<00:08, 26.56it/s]Computing importance (V4):   3%|▎         | 7/230 [00:00<00:07, 28.83it/s]Computing importance (V4):   4%|▍         | 10/230 [00:00<00:07, 28.35it/s]Computing importance (V4):   6%|▌         | 13/230 [00:00<00:07, 28.93it/s]Computing importance (V4):   7%|▋         | 17/230 [00:00<00:07, 28.64it/s]Computing importance (V4):   9%|▊         | 20/230 [00:00<00:07, 27.35it/s]Computing importance (V4):  10%|█         | 23/230 [00:00<00:07, 27.55it/s]Computing importance (V4):  11%|█▏        | 26/230 [00:00<00:07, 27.75it/s]Computing importance (V4):  13%|█▎        | 29/230 [00:01<00:07, 27.92it/s]Computing importance (V4):  14%|█▍        | 32/230 [00:01<00:07, 26.94it/s]Computing importance (V4):  16%|█▌        | 36/230 [00:01<00:06, 28.59it/s]Computing importance (V4):  17%|█▋        | 40/230 [00:01<00:06, 29.51it/s]Computing importance (V4):  19%|█▊        | 43/230 [00:01<00:06, 28.62it/s]Computing importance (V4):  20%|██        | 47/230 [00:01<00:06, 28.49it/s]Computing importance (V4):  22%|██▏       | 51/230 [00:01<00:05, 29.90it/s]Computing importance (V4):  23%|██▎       | 54/230 [00:01<00:06, 28.68it/s]Computing importance (V4):  25%|██▌       | 58/230 [00:02<00:05, 29.19it/s]Computing importance (V4):  27%|██▋       | 62/230 [00:02<00:05, 29.67it/s]Computing importance (V4):  28%|██▊       | 65/230 [00:02<00:05, 28.07it/s]Computing importance (V4):  30%|██▉       | 68/230 [00:02<00:05, 27.27it/s]Computing importance (V4):  31%|███       | 71/230 [00:02<00:05, 26.88it/s]Computing importance (V4):  33%|███▎      | 75/230 [00:02<00:05, 29.01it/s]Computing importance (V4):  34%|███▍      | 78/230 [00:02<00:05, 27.80it/s]Computing importance (V4):  35%|███▌      | 81/230 [00:02<00:05, 27.60it/s]Computing importance (V4):  37%|███▋      | 85/230 [00:02<00:04, 29.09it/s]Computing importance (V4):  39%|███▊      | 89/230 [00:03<00:04, 30.22it/s]Computing importance (V4):  40%|████      | 93/230 [00:03<00:04, 28.91it/s]Computing importance (V4):  42%|████▏     | 96/230 [00:03<00:04, 28.28it/s]Computing importance (V4):  43%|████▎     | 99/230 [00:03<00:04, 27.28it/s]Computing importance (V4):  44%|████▍     | 102/230 [00:03<00:04, 27.72it/s]Computing importance (V4):  46%|████▌     | 106/230 [00:03<00:04, 28.48it/s]Computing importance (V4):  48%|████▊     | 110/230 [00:03<00:04, 28.33it/s]Computing importance (V4):  50%|████▉     | 114/230 [00:04<00:03, 29.29it/s]Computing importance (V4):  51%|█████     | 117/230 [00:04<00:03, 29.28it/s]Computing importance (V4):  52%|█████▏    | 120/230 [00:04<00:03, 28.02it/s]Computing importance (V4):  53%|█████▎    | 123/230 [00:04<00:03, 28.15it/s]Computing importance (V4):  55%|█████▌    | 127/230 [00:04<00:03, 29.31it/s]Computing importance (V4):  57%|█████▋    | 130/230 [00:04<00:03, 27.99it/s]Computing importance (V4):  58%|█████▊    | 134/230 [00:04<00:03, 28.90it/s]Computing importance (V4):  60%|█████▉    | 137/230 [00:04<00:03, 28.27it/s]Computing importance (V4):  61%|██████    | 140/230 [00:04<00:03, 27.56it/s]Computing importance (V4):  63%|██████▎   | 144/230 [00:05<00:02, 29.33it/s]Computing importance (V4):  64%|██████▍   | 148/230 [00:05<00:02, 30.21it/s]Computing importance (V4):  66%|██████▌   | 152/230 [00:05<00:02, 30.68it/s]Computing importance (V4):  68%|██████▊   | 156/230 [00:05<00:02, 30.40it/s]Computing importance (V4):  70%|██████▉   | 160/230 [00:05<00:02, 30.80it/s]Computing importance (V4):  71%|███████▏  | 164/230 [00:05<00:02, 30.89it/s]Computing importance (V4):  73%|███████▎  | 168/230 [00:05<00:02, 30.37it/s]Computing importance (V4):  75%|███████▍  | 172/230 [00:05<00:01, 29.78it/s]Computing importance (V4):  77%|███████▋  | 176/230 [00:06<00:01, 30.62it/s]Computing importance (V4):  78%|███████▊  | 180/230 [00:06<00:01, 30.14it/s]Computing importance (V4):  80%|████████  | 184/230 [00:06<00:01, 28.95it/s]Computing importance (V4):  81%|████████▏ | 187/230 [00:06<00:01, 28.58it/s]Computing importance (V4):  83%|████████▎ | 190/230 [00:06<00:01, 27.20it/s]Computing importance (V4):  84%|████████▍ | 193/230 [00:06<00:01, 27.86it/s]Computing importance (V4):  85%|████████▌ | 196/230 [00:06<00:01, 27.65it/s]Computing importance (V4):  87%|████████▋ | 199/230 [00:06<00:01, 28.18it/s]Computing importance (V4):  88%|████████▊ | 202/230 [00:07<00:01, 26.84it/s]Computing importance (V4):  90%|████████▉ | 206/230 [00:07<00:00, 28.24it/s]Computing importance (V4):  91%|█████████ | 209/230 [00:07<00:00, 27.84it/s]Computing importance (V4):  92%|█████████▏| 212/230 [00:07<00:00, 27.55it/s]Computing importance (V4):  93%|█████████▎| 215/230 [00:07<00:00, 28.21it/s]Computing importance (V4):  95%|█████████▌| 219/230 [00:07<00:00, 29.55it/s]Computing importance (V4):  97%|█████████▋| 223/230 [00:07<00:00, 29.13it/s]Computing importance (V4):  98%|█████████▊| 226/230 [00:07<00:00, 28.44it/s]Computing importance (V4): 100%|█████████▉| 229/230 [00:07<00:00, 27.91it/s]Computing importance (V4): 100%|██████████| 230/230 [00:08<00:00, 28.64it/s]

[V4] Gradient Component Statistics (Mean Values):
--------------------------------------------------
Component          Raw Value   Relative %
--------------------------------------------------
xyz                 0.000003       79.02%
scaling             0.000000        1.40%
rotation            0.000000        3.72%
dc                  0.000000        3.18%
sh                  0.000001       12.30%
opacity             0.000000        0.39%
--------------------------------------------------

[V4] Weighted Gradient Contributions:
--------------------------------------------------
Component         Weight    Contrib %
--------------------------------------------------
xyz                 0.02       24.16%
scaling             1.00       21.40%
rotation            0.20       11.37%
dc                  0.10        4.86%
sh                  0.20       37.62%
opacity             0.10        0.60%
--------------------------------------------------

[Baseline] ...
psnr:  28.99423229333126
  Baseline render time:   0.35 s
  Baseline PSNR:          28.9942 dB

[Search] [Seed] pruning_rate=0.70, sh_rate=0.20, mem_score=1.460, ΔPSNR=0.4577 dB [OK]
  Deep copy time:         0.0006 s
  Prune time:             0.40 s
psnr:  28.53654890349417
  Render time: 0.17s
  PSNR after pruning: 28.5365
  ΔPSNR after pruning: 0.4577 dB
  [INFO] New best config: mem_score=1.460, ΔPSNR=0.4577 dB

[Search] [Neighbor] pruning_rate=0.71, sh_rate=0.20, mem_score=1.478, ΔPSNR=0.5128 dB [OK]
  Deep copy time:         0.0004 s
  Prune time:             0.39 s
psnr:  28.481429880315606
  Render time: 0.17s
  PSNR after pruning: 28.4814
  ΔPSNR after pruning: 0.5128 dB
  [INFO] New best config: mem_score=1.478, ΔPSNR=0.5128 dB
  [INFO] Queue cleanup: removed 1 low mem_score configs (queue: 3 -> 2)

[Search] [Neighbor] pruning_rate=0.72, sh_rate=0.20, mem_score=1.496, ΔPSNR=0.5762 dB [FAIL]
  Deep copy time:         0.0003 s
  Prune time:             0.39 s
psnr:  28.41804411917022
  Render time: 0.16s
  PSNR after pruning: 28.4180
  ΔPSNR after pruning: 0.5762 dB
  Exceeds target drop (0.5500 dB); skipping quantization for this config.

[Search] [Neighbor] pruning_rate=0.71, sh_rate=0.21, mem_score=1.488, ΔPSNR=0.5401 dB [OK]
  Deep copy time:         0.0004 s
  Prune time:             0.40 s
psnr:  28.454119248823687
  Render time: 0.17s
  PSNR after pruning: 28.4541
  ΔPSNR after pruning: 0.5401 dB
  [INFO] New best config: mem_score=1.488, ΔPSNR=0.5401 dB

[INFO] Early stop in neighbor search: best PSNR drop (0.5401 dB) >= 95% of target (0.5500 dB)

[Search] Total configurations evaluated: 4

[Finalize] Running quantization for pruning_rate=0.71, sh_rate=0.21
  Deep copy time:         0.0003 s
  Prune time:             0.39 s
psnr:  28.454119248823687
  Render time: 35.40s
  PSNR after pruning: 28.4541
  ΔPSNR after pruning: 0.5401 dB
  Quantization breakdown -> prep_tensors: 0.000s, zero_mask_split: 0.001s, xyz_quant_morton: 0.006s, cpu_transfer: 0.064s, xyz_q16_encode: 0.219s, f_rest_int4: 0.866s, int8_pack: 0.913s
  Quantization time:      2.07 s
  Dequantization time:    0.97 s
  Estimated size:         20.64 MB
  Storage ratio vs input: 2.56%
[INFO] Storage breakdown:
    M_int8_compressed: 10.15 MB (49.16%)
    xyz_q16_compressed: 5.14 MB (24.88%)
    M_rest_compressed: 4.84 MB (23.46%)
    Z_rest: 175.83 KB (0.83%)
    S_rest: 175.83 KB (0.83%)
    Z_int8: 85.99 KB (0.41%)
    S_int8: 85.99 KB (0.41%)
    npz_path: 213.00 B (0.00%)
    int8_names: 131.00 B (0.00%)
    xyz_codec_used: 120.00 B (0.00%)
    compression_method: 120.00 B (0.00%)
    xyz_codec: 115.00 B (0.00%)
    xyz_q16_shape_uint16: 109.00 B (0.00%)
    xyz_q16_shape_bytes: 108.00 B (0.00%)
    xyz_q16_view_shape: 107.00 B (0.00%)
    M_rest_shape: 101.00 B (0.00%)
    M_int8_shape: 101.00 B (0.00%)
    int4_names: 99.00 B (0.00%)
    int2_names: 99.00 B (0.00%)
    fp16_names: 99.00 B (0.00%)
    segment_size_f_rest: 96.00 B (0.00%)
    use_entropy_coding: 95.00 B (0.00%)
    compression_level: 94.00 B (0.00%)
    boundary_index: 91.00 B (0.00%)
    num_segments: 89.00 B (0.00%)
    bits_f_rest: 88.00 B (0.00%)
    xyz_qbits: 86.00 B (0.00%)
    sh_all_zero: 84.00 B (0.00%)
    N_rest: 83.00 B (0.00%)
    N: 78.00 B (0.00%)
    xyz_mins: 69.00 B (0.00%)
    xyz_maxs: 69.00 B (0.00%)
psnr:  28.44468353733872
  Final render time:      35.32 s
  Final PSNR:             28.4447 dB
  ΔPSNR from input:       0.5495 dB

Search complete.

============================================================
Best combination found: pruning=0.710, sh=0.210

[INFO] Best config:           pruning_rate = 0.710, sh_rate = 0.210
[INFO] Base PSNR:             28.9942 dB
[INFO] Best PSNR:             28.4447 dB
[INFO] PSNR drop:             0.5495 dB
[INFO] Input file size:       805.36 MB
[INFO] Output file size:      20.64 MB
[INFO] Compression ratio:     39.01x
============================================================
 Saving render results ...
  Deep copy time:         0.0007 s
  Prune time:             0.40 s
psnr:  28.454119248823687
  Render time: 35.24s
  PSNR after pruning: 28.4541
  ΔPSNR after pruning: 0.5401 dB

============================================================
[STATS] Pipeline Time Breakdown:
  Load time:      9.70 s
  Score time:    11.25 s
  Search time:   76.74 s
  Store time:    35.70 s
  Total time:   133.39 s
============================================================
	Command being timed: "python /home/kemove/github/FlexGaussian/compress.py -s /home/kemove/data/db/drjohnson -m /home/kemove/data/3dgs-model/drjohnson --output_path /home/kemove/efficient-output --quality_target_diff 0.55 --eval --compression_method zlib --compression_level 4 --xyz_codec morton16 --segments 1000 --use_importance_v4 True --topk_views_percent 0.1 --view_importance_weight 2.0 --save_render True"
	User time (seconds): 452.01
	System time (seconds): 28.89
	Percent of CPU this job got: 354%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 2:15.82
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 11042744
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 155
	Minor (reclaiming a frame) page faults: 2765467
	Voluntary context switches: 53680
	Involuntary context switches: 2376
	Swaps: 0
	File system inputs: 0
	File system outputs: 474112
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
